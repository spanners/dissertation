<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="" />
  <title>The potential of declarative programming languages to support user interface programming: the case of Elm</title>
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
<link rel="stylesheet" href="css/master.css" />
<STYLE type="text/css">
   .toc li {list-style-type: none }
   dd {padding: 8px 16px}
 </STYLE>
<noscript>
<link rel="stylesheet" href="css/mobile.min.css" />
</noscript>
<script>
// Edit to suit your needs.
var ADAPT_CONFIG = {
  // Where is your CSS?
  path: 'css/',

  // false = Only run once, when page first loads.
  // true = Change on window resize and page tilt.
  dynamic: true,

  // First range entry is the minimum.
  // Last range entry is the maximum.
  // Separate ranges by "to" keyword.
  range: [
    '0px    to 760px  = mobile.min.css',
    '760px  to 980px  = 720.min.css',
    '980px  to 1280px = 960.min.css',
    '1280px to 1600px = 1200.min.css',
    '1600px to 1940px = 1560.min.css',
    '1940px to 2540px = 1920.min.css',
    '2540px           = 2520.min.css'
  ]
};
</script>
<script src="js/adapt.min.js"></script>
</head>
<body>
<div class="container_12">
<div class="grid_3 toc">
<h3>Table of Contents</h3>
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#requirements"><span class="toc-section-number">2</span> Requirements</a><ul>
<li><a href="#requirement-definitions"><span class="toc-section-number">2.1</span> Requirement definitions</a><ul>
<li><a href="#numbering-and-referencing-system"><span class="toc-section-number">2.1.1</span> Numbering and referencing system</a></li>
<li><a href="#priorities-system"><span class="toc-section-number">2.1.2</span> Priorities system</a></li>
</ul></li>
<li><a href="#functional-requirements"><span class="toc-section-number">2.2</span> Functional Requirements</a></li>
<li><a href="#non-functional-requirements"><span class="toc-section-number">2.3</span> Non-Functional Requirements</a></li>
</ul></li>
<li><a href="#project-plan"><span class="toc-section-number">3</span> Project Plan</a><ul>
<li><a href="#the-plan"><span class="toc-section-number">3.1</span> The plan</a></li>
<li><a href="#required-resources"><span class="toc-section-number">3.2</span> Required Resources</a></li>
</ul></li>
<li><a href="#ethical-considerations"><span class="toc-section-number">4</span> Ethical considerations</a></li>
<li><a href="#pilot-study"><span class="toc-section-number">5</span> Pilot Study</a><ul>
<li><a href="#method"><span class="toc-section-number">5.1</span> Method</a><ul>
<li><a href="#observations"><span class="toc-section-number">5.1.1</span> Observations</a></li>
<li><a href="#modification-to-experimental-methodology"><span class="toc-section-number">5.1.2</span> Modification to experimental methodology</a></li>
</ul></li>
<li><a href="#method-1"><span class="toc-section-number">5.2</span> Method</a></li>
<li><a href="#hypotheses"><span class="toc-section-number">5.3</span> Hypotheses</a></li>
</ul></li>
<li><a href="#literature-survey"><span class="toc-section-number">6</span> Literature Survey</a><ul>
<li><a href="#introduction-to-the-problem-area"><span class="toc-section-number">6.1</span> Introduction to the problem area</a></li>
<li><a href="#what-does-it-mean-to-be-easy-to-use"><span class="toc-section-number">6.2</span> What does it mean to be ‘easy to use?’</a></li>
<li><a href="#running-user-studies"><span class="toc-section-number">6.3</span> Running User Studies</a></li>
</ul></li>
<li><a href="#requirements-1"><span class="toc-section-number">7</span> Requirements</a></li>
<li><a href="#design"><span class="toc-section-number">8</span> Design</a><ul>
<li><a href="#pilot-study-1"><span class="toc-section-number">8.1</span> Pilot study</a><ul>
<li><a href="#reading-material"><span class="toc-section-number">8.1.1</span> Reading material</a></li>
<li><a href="#leon-asked-us-to-answer-these-questions-and-bring-a-notebook"><span class="toc-section-number">8.1.2</span> Leon asked us to answer these questions and bring a notebook:</a></li>
</ul></li>
<li><a href="#experimental-design"><span class="toc-section-number">8.2</span> Experimental design</a><ul>
<li><a href="#am-in-stv"><span class="toc-section-number">8.2.1</span> 30/10/2013 @ 9:15 am in STV</a></li>
<li><a href="#wed-mar-25-1430-gmt-2014"><span class="toc-section-number">8.2.2</span> Wed Mar 25 14:30 GMT 2014</a></li>
<li><a href="#tue-apr-1-143000-bst-2014"><span class="toc-section-number">8.2.3</span> Tue Apr 1 14:30:00 BST 2014</a></li>
<li><a href="#tuesday-apr-8-143000-bst-2014"><span class="toc-section-number">8.2.4</span> Tuesday Apr 8 14:30:00 BST 2014</a></li>
</ul></li>
</ul></li>
<li><a href="#implementation-and-testing"><span class="toc-section-number">9</span> Implementation and Testing</a></li>
<li><a href="#results"><span class="toc-section-number">10</span> Results</a><ul>
<li><a href="#tue-apr-15-155038-bst-2014"><span class="toc-section-number">10.0.1</span> Tue Apr 15 15:50:38 BST 2014</a></li>
</ul></li>
<li><a href="#conclusions"><span class="toc-section-number">11</span> Conclusions</a></li>
</ul>
</div> <!-- Grid 3 -->
<div class="grid_9">
<header>
<h1 class="title">The potential of declarative programming languages to support user interface programming: the case of Elm</h1>
</header>
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>I am interested in the effect of Functional Reactive Programming [FRP] on User Interface programming.</p>
<p>I first grew an interest in the field of Functional Reactive Programming after seeing Bret Victor’s “Inventing on Principle” <span class="citation" data-cites="Victor2012a">Victor (2012)</span>. His talk claims that, in the traditional compile-run-debug cycle of coding, “most of the developer’s time is spent looking at the code, blindly without an immediate connection to the thing they’re making”. He goes on to show a side-by-side illustration of a new style of development – on one side is the runtime preview, and on the other side is the code pertaining to said runtime. Changes in the code update the runtime, live. He argues that “so much of creation is discovery, and you can’t discover anything if you can’t see what you’re doing” – alluding to his earlier statement that the compile-run-debug cycle is much like this. I would like to investigate the claims Bret Victor makes, and indeed Elm, an instance of such a FRP, whose website also makes similar claims.</p>
<p>A counter-argument may be that this is much like giving a child a chainsaw. Is it too powerful? Does this tight feedback loop cut out a perhaps crucial pause for thought? Furthermore – is this appropriate for all types of programming? Is it at least appropriate for User Interface design? It has been shown that novices tend to “thrash” about, trying out many ideas that may or may not be a solution, whereas experts think much more about the problem at hand before proceeding with a solution <span class="citation" data-cites="Lopez2012a">Lopez et al. (2012)</span>.</p>
<p>My goal is to answer these questions. By way of conducting user studies, leveraging Elm with extensions to do A/B testing to illustrate it’s effectiveness (or ineffectiveness) at enhancing User Interface Design.</p>
<p>As far as the scope of this project goes, I will be researching as much as is necessary in order to meet the aims of the project listed [itm:aims]. Should I complete these aims, I may go on to do further user studies, or attempt to further analyse, compare and contrast User Interface Design and Declarative/Functional Reactive Programming languages against other methods, so as to make firmer statements about the benefits of Elm.</p>
<h1 id="requirements"><span class="header-section-number">2</span> Requirements</h1>
<p>I will now identify what the requirements are for the project.</p>
<h2 id="requirement-definitions"><span class="header-section-number">2.1</span> Requirement definitions</h2>
<h3 id="numbering-and-referencing-system"><span class="header-section-number">2.1.1</span> Numbering and referencing system</h3>
<p>Below is an example requirement illustrating the requirement numbering system in use:</p>
<ol type="1">
<li><p>High-level, abstract title which sums up the topic of the associated requirements (E.g. Compare two pieces of program text) [itm:example]</p>
<ol type="1">
<li>Requirement associated with high-level title (E.g. The program must show if the two input texts are the same or different) [itm:example-requirement] <strong>Priority</strong> of requirement (<strong>High</strong>, <strong>Medium</strong> or <strong>Low</strong>).</li>
</ol></li>
</ol>
<p>Here I am referencing the above abstract title: [itm:example]</p>
<p>Here I am referencing the above requirement: [itm:example-requirement]</p>
<h3 id="priorities-system"><span class="header-section-number">2.1.2</span> Priorities system</h3>
<p>Below are the meanings of priorities:</p>
<ul>
<li><p>Priorities may be <strong>High</strong> or <strong>Medium</strong> or <strong>Low</strong></p></li>
<li><p>A <strong>High</strong> priority requirement is one that is crucial for the system to function. They feature the word ‘must’.</p></li>
<li><p><strong>Medium</strong> – provides additional utility to the system. They feature the word ‘should’.</p></li>
<li><p><strong>Low</strong> – is an ancillary feature that adds desirable functionality to the system. They feature the word ‘could’.</p></li>
</ul>
<h2 id="functional-requirements"><span class="header-section-number">2.2</span> Functional Requirements</h2>
<ol type="1">
<li><p>Write software to assist the capture of objective data to inform me of the user’s activities as they use the Elm IDE.</p>
<ol type="1">
<li>The program must be able to work offline and later transfer collected data to me once a connection is resumed, collecting mouse and keyboard activity<br /> <strong>Priority: High</strong></li>
</ol></li>
<li><p>Perform Pilot and User Studies</p>
<ol type="1">
<li><p>I must perform Pilot and User Studies in an iterative fashion, each one learning and building upon discoveries made in prior ones, starting vague and getting more and more focused on a particular facet of User Interface Design and/or Declarative programming as an activity.<br /> <strong>Priority: High</strong></p></li>
<li><p>I must use these studies to inform experimental and software design to disambiguate and filter data collected in the experiment, and to exercise hypotheses.<br /> <strong>Priority: High</strong></p></li>
</ol></li>
</ol>
<h2 id="non-functional-requirements"><span class="header-section-number">2.3</span> Non-Functional Requirements</h2>
<ol type="1">
<li><p>Source code</p>
<ol type="1">
<li><p>The software must be written clearly and simply.<br /> <strong>Priority: High</strong></p></li>
<li><p>The software must have suitable, concise comments which explain the programs intent, but only where the code alone is not enough.<br /> <strong>Priority: High</strong></p></li>
</ol></li>
<li><p>Activity recording</p>
<ol type="1">
<li><p>The program activity recording feature must not slow down the user’s use of the IDE more than 1ms difference than without it.<br /> <strong>Priority: High</strong></p></li>
<li><p>There should be software to visualise the usage data<br /> <strong>Priority: Medium</strong></p></li>
</ol></li>
</ol>
<h1 id="project-plan"><span class="header-section-number">3</span> Project Plan</h1>
<p>I will now explain my current plan for the project. Notice that I say current here – this may change throughout the course of the project: I may narrow in on a topic of interest, or branch out to investigate anomalous research findings.</p>
<p>I will be building the end product – the dissertation and software – via a process of iterations, much like an iterative Software Lifecycle. The Literature Survey is ongoing – throughout the whole project from beginning to end – feeding into all parts of the dissertation, and indeed this Proposal, as shown in the Gantt chart (Figure<br />). The literature I choose is sometimes chosen to support points I wish to make, sometimes acting to guide my next area of research, reinforce findings, compare or contrast with other research, and probably many other things I have not yet thought of. Most importantly, I will be looking at who the paper/article etc. is cited by, preferring sources that are peer-reviewed.</p>
<p>As well as this literature research, I will also have an ongoing Product Literature Survey – looking at existing software out there that is related to my current area of interest.</p>
<p>Central to this idea of iteration is my desired method of performing user studies: I will first do what I have called a “Pilot” – a short and shallow trial User Study that focuses not on the research I’m concerned with, but instead the particular experimental design I would like to use in my actual User Study. By employing a Pilot I can hopefully get an idea of the nature of the experimental design – perhaps discovering any variables I had not previously considered that will require me to increase my sample size or simplify the experiment in order to mitigate their effect on the dependent variable I wish to test for. These are all problems discovered in <span class="citation" data-cites="Yates2012a">Yates (2012)</span> – including basic teething problems in getting the experiment to flow smoothly. In an even less detailed aspect, the pilot may allow me to look at what is out there. It may help to not look for anything in particular initially, and see what happens.</p>
<p>At this stage, with the help of discussion with my Project Supervisor, I have some ideas about how to gather data in User Studies and these pilots could prove to be a useful testbed for such tools. I have a hypothesis that the novice developer “thrashing” <span class="citation" data-cites="Lopez2012a">Lopez et al. (2012)</span> can be observed by shorter pauses between editing and experimentation, and I could measure this by way of measuring the mouse position relative to the IDE, clicks, and key-presses, using tools built-in to Elm and a bit of extension to stream this over the Internet to my storage facilities <span class="citation" data-cites="WhatFRP">Czaplicki (2013b)</span>.</p>
<p>As you will see in the Gantt chart (Figure ) I have included Testing &amp; Implementation under the same heading as I will be doing Test Driven Development. My experience on Placement at PicoChip, my job as a Software Engineer at Altran and readings have helped me realise that this way of developing is time-saving and improves code quality by enforcing modularity in order to test it <span class="citation" data-cites="Martin2008a">Martin (2008)</span> and <span class="citation" data-cites="Hunt2000a">Hunt &amp; Thomas (1999)</span>.</p>
<h2 id="the-plan"><span class="header-section-number">3.1</span> The plan</h2>
<figure>
<img src="gantt-chart.png" alt="Gantt Chart" /><figcaption>Gantt Chart</figcaption>
</figure>
<h2 id="required-resources"><span class="header-section-number">3.2</span> Required Resources</h2>
<p>I will now talk about the resources I require for the completion of this dissertation, including the availability of these resources.</p>
<p>I will require users for my user study. These users must be proficient in at least one programming language (declarative programming languages are niche in and of themselves, never mind the discipline of programming, so some basic knowledge is required in order to see useful patterns in User Interface Design). Suitable candidates are First and Second Year Computer Science students from most Universities in the UK. Their availability is limited – Christmas holidays and coursework deadlines may mean that certain periods of the term are particularly busy for them. At Bath, suitable periods are therefore November, January to Mid February (inclusive), Mid-March to April (inclusive). It will be useful to procure free periods for other nearby Universities to hedge my bets, and to have a decent random assignment of users so I can make equivalent groups in my experiments.</p>
<p>The ACM Digital library, accessible via the Bath portal either from University or from home via Single-sign-on is a valuable resource for research papers, articles and references. The Cited-By feature will allow me to assert the popularity/ranking of each resource. Another valuable resource is the Psychology of Programming Interest Group, a “[group of] people from diverse communities to explore common interests in the psychological aspects of programming and in the computational aspects of psychology”, with peer reviewed papers on particularly relevant topics to my area of research.</p>
<p>I will require regular access to the Internet, Emacs with haskell-mode installed and Elm version 0.10 <span class="citation" data-cites="Elm2013a">Czaplicki (2013a)</span>. I will also need git for software source control, and bitbucket.org for online, private backups of my work. I require LaTeX to type up my dissertation, and have chosen texlive on Ubuntu 12.04.3 as my development environment of choice. The full development environment is installed at the house I am staying in, in Bath, on my laptop. I am also able to replicate this environment to a satisfactory level at Bath University on any computer with access via Putty/SSH or similar to LCPU, as all the above software can be installed and run on my Bath University account.</p>
<p>I am using Chromium Version 28.0.1500.71 Ubuntu 12.04 (28.0.1500.71-0ubuntu1.12.04.1) to run the Elm IDE, which is an important dependency that may cause problems in getting Users in User Studies to run a functionally equivalent browser. Only recent editions of Chrome, Chromium, Firefox, Opera and Safari (not Internet Explorer) support Elm web programs.</p>
<h1 id="ethical-considerations"><span class="header-section-number">4</span> Ethical considerations</h1>
<p>In conducting User Studies, I will be interacting with people and collecting data from them, so I must be considerate and mindful of those I talk to and the information I handle.</p>
<p>An Ethical Checklist such as the one Bath University uses as it’s template <span class="citation" data-cites="Bath2013a">Bath (2013)</span> may assist my research such that I treat each participant with care and respect. I may learn from the discoveries made by others – in my reading, I came across a paper (also mentioned earlier) that highlighted concerns that participants under study had, and the paper detailed ways to mitigate these concerns so as to make the participant feel that are informed and safe <span class="citation" data-cites="Yates2012a">Yates (2012)</span>.</p>
<h1 id="pilot-study"><span class="header-section-number">5</span> Pilot Study</h1>
<p>Using per-participant questionnaire (See ), I captured video &amp; audio data of participants while the completed the task of extending a mario game to make mario fly</p>
<h2 id="method"><span class="header-section-number">5.1</span> Method</h2>
<h3 id="observations"><span class="header-section-number">5.1.1</span> Observations</h3>
<p>Using Thematic analysis <span class="citation" data-cites="Braun2006Thematic">(Braun &amp; Clarke, 2006)</span> to code the data</p>
<h3 id="modification-to-experimental-methodology"><span class="header-section-number">5.1.2</span> Modification to experimental methodology</h3>
<p>More objective!</p>
<h2 id="method-1"><span class="header-section-number">5.2</span> Method</h2>
<p>A 2×2×2 study, that is 2 Languages (Elm and JavaScript), 2 Region difficulties (Hard and Simple) and 2 Region relevances (Relevant and Not relevant) will be done to determine if the number of mouse</p>
<h2 id="hypotheses"><span class="header-section-number">5.3</span> Hypotheses</h2>
<p>1H.</p>
<h1 id="literature-survey"><span class="header-section-number">6</span> Literature Survey</h1>
<h2 id="introduction-to-the-problem-area"><span class="header-section-number">6.1</span> Introduction to the problem area</h2>
<!--
Spending half an hour making a mind-map, starting with the word "Elm", I
get the following terms:

-   Signals

    -   Impure

    -   Time

    -   Input/Output

    -   History – Past & Future

    -   Data model

-   "Natural" Separation of Data model/Logic/Layout

-   Less cognitive load?

-   "Easy"

    -   Professed to be "easy" by the creator!

    -   What does it mean to be "easy"?

    -   Operationalisation

    -   Self-reporting

-   Programming Language

    -   Reactive

        -   "Instant feedback"

        -   "I/O-sensitive"

        -   Thrashing?

    -   Functional

        -   Pure

        -   Testing

            -   properties

            -   QuickCheck

            -   Delta Debugging

    -   Haskell derivative

        -   Embedded Domain-specific Language

        -   See also: Idris

    -   Multiple back-ends

        -   Javascript

        -   Java

        -   C

-   Programming

    -   code-compile-run loop

        -   "Programming blind"

        -   "Slow feedback"

    -   Text editor

    -   IDE

    -   Paradigms

        -   Declarative

        -   I'll tell you WHAT I want you to do, you figure out HOW to
            do it

    -   Encoding ideas

        -   Mapping of natural language concepts into formal language

        -   Loss of information?

        -   Augmented reality?

    -   Abstraction

        -   What level?

        -   What generation? 3GL? 4GL?

        -   Metaprogramming e.g. AspectJ

        -   Black/White box

    -   Cognitive offloading

    -   What is it?

        -   Art?

        -   Engineering?

        -   Science?

        -   Language?

        -   Mathematics?

        -   Ephemeral

        -   Intangible

        -   Limitless

        -   Limited

-   IDE

    -   Split View: Code | Runtime

-   Feedback

    -   "Instant-update"

    -   On-the-fly
-->

<p>The problem area of user-interface programming, and more generally, the activity of programming in a context such as a software engineering environment, encompasses certain realms of interest. Through my survey of literature, my research has touched upon the above-mentioned terms, and I have discovered some thought-provoking problems that exist in the field of programming. The concept of ‘Programming’ embodies other concepts – art-forms, engineering processes, science, language, and mathematics, among others. To me, programming is a creative endeavour unlike any other – in which the programmer wields materials of no substance – the code – by manipulating symbols on a screen, which represent states in the machine being used. There are so many programming languages, and all languages (all that are Turing-complete) reduce to the same language – that of a Turing Machine. So, <em>why do we have so many programming languages?</em>.</p>
<p><em>Beware of the Turing tar-pit in which everything is possible but nothing of interest is easy.</em> <span class="citation" data-cites="PerlisTuringTarpit">(Perlis, 1982)</span></p>
<p>Different languages lend themselves to different ways of thinking about problems. They may place emphasis on one feature, for example list manipulation and hide others such as types. The language or programming environment may make explicit the effect of changes as they are encoded, as opposed to queuing up a block of changes and the programmer having to initiate an update manually.</p>
<p>I would like to draw your attention in particular to the terms <strong>Abstraction</strong>, <strong>Cognitive offloading</strong>, <strong>Feedback</strong>, <strong>Loss of information?</strong>/<strong>Augmented reality?</strong>, <strong>Thrashing</strong>, and <strong>“Programming blind”</strong>. These, at current, are my topics of interest, and my literature review has up to this point been inextricably and heavily influenced by this.</p>
<h2 id="what-does-it-mean-to-be-easy-to-use"><span class="header-section-number">6.2</span> What does it mean to be ‘easy to use?’</h2>
<p>In the process of surveying relevant (and sometimes irrelevant) literature to this dissertation, recurring conceptual patterns were observed – one particular instance of this is that several authors seem to lay victim to the trap of claiming their creation is “easy to use”, “better”, “simpler than <span class="math"><em>x</em></span>” without providing any supportive evidence of this.</p>
<p>Perhaps these are incidents of ‘experimenter bias’ – where the evaluator is naturally predisposed to a positive appraisal of their own findings. One way to avoid this is to have one set of people perform the data capture and another set perform the data analysis. Nevertheless, these patterns emerge, and present numerous opportunities for experimentation and subsequent evidence supporting or contradicting these claims. Experiments may see if the same conclusions are reached as the above-mentioned authors, accounting for the ‘evaluator effect’ <span class="citation" data-cites="Hertzum2001">(Hertzum &amp; Jacobsen, 2001)</span>.</p>
<p>Whether this particular route is taken for experimentation hinges on pilot studies that will be conducted concurrently to the Literature Survey, each inextricably shaping the other’s direction of investigation and inquiry.</p>
<p>The catalyst to this whole dissertation was a talk about the concept of a highly reactive development environment – where changes in the code result in instantaneous updates to the runtime, ‘on-the-fly’. This was presented in Bret Victor’s “Inventing on Principle” <span class="citation" data-cites="Victor2012a">(Victor, 2012)</span>. In his presentation Bret makes several assertions about the ‘traditional’ style of coding, one statement of which is that “most of the developer’s time is spent looking at the code, blindly without an immediate connection to the thing they’re making”. He argues that “so much of creation is discovery, and you can’t discover anything if you can’t see what you’re doing” – alluding to his earlier statement that the compile-run-debug cycle is much like this.</p>
<p>Evan Czaplicki, in his thesis of which Elm is the product <span class="citation" data-cites="Czaplicki2012elm">(Czaplicki, 2012)</span>, makes similar claims – “[Elm] makes it <em>quick and easy</em> to create and combine text, images, and video into rich multimedia displays.” While the evaluation of Elm’s usability is not the focus of the thesis, rather, it is to establish a context for Functional Reactive Programming and describe the implementation details, he makes other usability claims without evidence – “[non-declarative frameworks for graphical user interfaces] mire programmers in the many small, nonessential details of handling user input and modifying the display.”, “FRP makes GUI programming much more manageable”, and in a section entitled <em>The Benefits of Functional GUIs</em>, “In Elm, divisions between data code, display code, and user interaction code arise fairly naturally, helping programmers write robust GUI code”. If these claims are true, there is all the more evidence that Elm should be a language of choice for GUI programmers, but experiments must be done to determine this.</p>
<p>And perhaps this rapid development cycle is not always suitable – in their 2012 paper, Lopez et al. show that novices tend to “thrash” about, trying out many ideas that may or may not be a solution, and executing “poorly directed, ineffective problem solving …failing to realise they are doing it in good time, and fail to break out of it”, whereas experts think much more about the problem at hand before proceeding with a solution <span class="citation" data-cites="Lopez2012a">(Lopez et al., 2012)</span>.</p>
<h2 id="running-user-studies"><span class="header-section-number">6.3</span> Running User Studies</h2>
<p>Perhaps a further direction of investigation may be running an experiment to spot whether or not Elm’s auto-updating IDE lends to a lack of critical thinking – some operationalization may be <em>pauses reported as ‘thinking’ made during development</em> – where a pause is disambiguated as ‘thinking’ by the experimenter asking the participant why they did not perform any interaction with the computer for more than 10 seconds, and the participant reports that they were planning/designing/other similar activity. Along this line of thinking, a paper studying the relationship between speech pauses and cognitive load <span class="citation" data-cites="Khawaja2008">(Khawaja et al., 2008)</span> found through studying 48 mixed gender participants that there is statistically significant indicators of cognitive load through analysing pauses in speech. Perhaps this concept of pauses can be applied to the activity of programming. However, the planned method of disambiguating pauses via self-reporting (previously mentioned) would not be suitable according to these authors – “such measures can be either physically or psychologically intrusive and disrupt the normal flow of the interaction”, although a paper cited by <span class="citation" data-cites="Khawaja2008">(Khawaja et al., 2008)</span> itself claims that “although self-ratings may appear questionable, it has been demonstrated that people are quite capable of giving a numerical indication of their perceived mental burden <span class="citation" data-cites="Gopher1984">(Gopher &amp; Braune, 1984)</span>”. Indeed a pilot study by Fraser and Kölling <span class="citation" data-cites="McKay2012">(McKay &amp; K<span>ö</span>lling, 2012)</span> structures the self-reporting by getting the users to evaluate an IDE as they use it using a set of subject-specific heuristics that they have designed. They showed that this customised set of heuristics helped guide the user more effectively than Nielsen’s heuristics in evaluating usability, so one could develop a custom set of heuristics for evaluating the usability of Elm.</p>
<p>From the Elm thesis <span class="citation" data-cites="Czaplicki2012elm">(Czaplicki, 2012)</span>, the language syntax and rapid feedback seem simple enough that it is conceivable (or at the very least, possible and of experimental interest) to allow the user to customise the UI layout to their liking. Letting the user shape the UI in concert with a UI programmer is covered the study of the interface development environment “Mobi-D” in millitary and medical applications <span class="citation" data-cites="Puerta1997">(Puerta, 1997)</span>, with success in those fields. It may be worth speculating how Elm would fit into the development cycle that Puerta’s paper outlines, as this may lend inspiration to potential user interface enhancements to the Elm IDE for A/B testing. It must be noted that there does not seem to be a re-emergence of Mobi-D since the paper was written, however.</p>
<p>My goal is to answer these questions. By way of conducting user studies, leveraging Elm with extensions to do A/B testing to illustrate it’s effectiveness (or ineffectiveness) at enhancing User Interface Design.</p>
<p>Central to this idea of iteration is my desired method of performing user studies: I will first do what I have called a “Pilot” – a short and shallow trial User Study that focuses not on the research I’m concerned with, but instead the particular experimental design I would like to use in my actual User Study. By employing a Pilot I can hopefully get an idea of the nature of the experimental design – perhaps discovering any variables I had not previously considered that will require me to increase my sample size or simplify the experiment in order to mitigate their effect on the dependent variable I wish to test for. These are all problems discovered in <span class="citation" data-cites="Yates2012a">(Yates, 2012)</span> – including basic teething problems in getting the experiment to flow smoothly. In an even less detailed aspect, the pilot may allow me to look at what is out there. It may help to not look for anything in particular initially, and see what happens.</p>
<p>At this stage, with the help of discussion with my Project Supervisor, I have some ideas about how to gather data in User Studies and these pilots could prove to be a useful testbed for such tools. I have a hypothesis that the novice developer “thrashing” <span class="citation" data-cites="Lopez2012a">(Lopez et al., 2012)</span> can be observed by shorter pauses between editing and experimentation, and I could measure this by way of measuring the mouse position relative to the IDE, clicks, and key-presses, using tools built-in to Elm and a bit of extension to stream this over the Internet to my storage facilities <span class="citation" data-cites="WhatFRP">(Czaplicki, 2013b)</span>.</p>
<h1 id="requirements-1"><span class="header-section-number">7</span> Requirements</h1>
<p>If you are doing a primarily software development project, this is the chapter in which you review the requirements decisions and critique the requirements process.</p>
<h1 id="design"><span class="header-section-number">8</span> Design</h1>
<p>This is the chapter in which you review your design decisions at various levels and critique the design process.</p>
<h2 id="pilot-study-1"><span class="header-section-number">8.1</span> Pilot study</h2>
<p>In reflection, the task I chose was too difficult to capture the cognitive load incurred by the language itself for a given task, due to the difficulty of the task itself creating noise. I could improve this by simplifying the task, in a way that is ‘language agnostic’, i.e. that is not idiomatic of Elm or JavaScript (the two languages that I am comparing). Something like the following will never be that easy in JavaScript:</p>
<table class="sourceCode haskell numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell">main <span class="fu">=</span> lift asText Mouse.position</code></pre></td></tr></table>
<p>Group meeting with Leon at East Building, 11:15 Friday 4th October 2013</p>
<p><strong>N.B. READ UP ON AND REMIND YOURSELF OF HCI STUFF (Year 2) AND SOFTWARE ENGINEERING STUFF (Year 1)</strong></p>
<h3 id="reading-material"><span class="header-section-number">8.1.1</span> Reading material</h3>
<p>In email repsonse to request for FYP meeting, <strong>Leon writes:</strong></p>
<p><em>Please do a bit of reading around beforehand. Go to the ACM Digital Library and search on ‘user interface programming’.</em></p>
<ol type="1">
<li><a href="http://libproxy.bath.ac.uk/login?qurl=http%3A%2F%2Fdl.acm.org%2Fevent.cfm%3Fid%3DRE151">ACM Conference on Human Factors in Computing Systems</a></li>
<li><a href="http://libproxy.bath.ac.uk/login?qurl=http%3A%2F%2Fdl.acm.org%2Fevent.cfm%3Fid%3DRE169">ACM CSCW: Conference on Computer Supported Cooperative Work</a></li>
<li><a href="http://libproxy.bath.ac.uk/login?qurl=http%3A%2F%2Fdl.acm.org%2Fevent.cfm%3Fid%3DRE172">ACM UIST: Symposium on User Interface Software and Technology</a></li>
</ol>
<p>In moodle project page, <strong>Leon writes:</strong></p>
<p><em>Your project must be related to contemporary developments in Human-Computer Interaction, and preferably to the part of the HCI world that focuses on interactive systems for collaboration</em></p>
<ol type="1">
<li>???</li>
<li>???</li>
</ol>
<p>Also In moodle project page, <strong>Leon also writes:</strong></p>
<p>*It normally starts with some user-centred research (observations, interviews, pilot experiment) to ground the problem, carried out concurrently with literature research.</p>
<p>The research problem is normally boiled down to something that can be addressed through the production of alternative versions of an interactive system.</p>
<p>This is closely followed by initial design work and the production of a rough but working prototype leading up to Christmas.</p>
<p>After the January exams, my students typically re-scope their research problem, based in the outcome of their initial work, and solidify their implementation ready for a full evaluation in March and April.*</p>
<p>Thus, my answers to the questions Leon posed should follow this structure in terms of what I want to get out of it. I can use the above structure to identify <strong>concerns</strong> of potential challenges in each step/combination of steps/step-transitions (e.g. step dependencies, resource procurement)</p>
<p>Also in moodle product page, <strong>Leon also writes:</strong></p>
<p><em>Students should prepare for their projects by refreshing their memories about Interaction from CM20216 activities. You should read about HCI in general, and support for collaboration in particular. Look at any or all of the following book chapters:</em></p>
<ul>
<li>Sharp, Rogers and Preece (2007) Interaction Design. hapter 4: Designing to Support Communication and Collaboration.</li>
<li>Dix, Finlay, Abowd and Beale (2004) Human-Computer Interaction. hapter 14: Communication and Collaboration Models.</li>
<li>Shneiderman and Plaisant (2005) Designing the User Interface. hapter 10: Collaboration.</li>
</ul>
<h3 id="leon-asked-us-to-answer-these-questions-and-bring-a-notebook"><span class="header-section-number">8.1.2</span> Leon asked us to answer these questions and bring a notebook:</h3>
<h4 id="q1.-what-i-hope-to-get-out-of-my-fyp-as-an-experience"><span class="header-section-number">8.1.2.1</span> Q1. What I hope to get out of my FYP as an experience?</h4>
<p>I hope to gain a deep and meaningful understanding of the programmer as a user, as an individual and the context of that individual – e.g. in a software team inside a department, inside a management structure… inside a company.</p>
<p>I hope to use this understanding to determine processes/work-flows that programmers experience in the endeavour of User Interface Design, both from the individual perspective and as a team.</p>
<p>Within these work flows, I wish to identify, in detail, metrics to gauge productivity, in order to measure this in experiments, perhaps doing A/B testing with Elm and some other, perhaps procedural language. This is an example of an objective measure.</p>
<p>I would also like to gather self-reported, more “fuzzy” feedback on user’s perception of their productivity – pain points, advantages, etc. they experience in using Language X to product a UI compared to Language Y (Declarative languages like Elm, etc)</p>
<p>I wish to verify, empirically, the comparisons and claims made on the <a href="">http://elm-lang.org/learn/What-is-FRP.elm</a> page of the elm-lang.org website, and those claimed it’s research paper (detailing the implementation of Elm, <strong>benefits</strong>, etc.)</p>
<p>In email again, <strong>Leon writes:</strong></p>
<p><em>The Elm site makes <strong>comparative statements.</strong> That is encouraging because it sets up opportunities for you to test some of the claims they make, and to ask new questions about Elm that its proponents may not have considered.</em></p>
<p>These are:</p>
<ol type="1">
<li>“most current frameworks for graphical user interfaces are not declarative. They mire programmers in the many small, nonessential details of handling user input and manually modifying the display.”</li>
<li>“with FRP, many of the irrelevant details are left to the compiler, freeing the programmer to think about things that matter.”</li>
<li>“Coding the examples on <a href="">http://elm-lang.org/Examples.elm</a> in a traditional GUI framework such as HTML/CSS/JavaScript . would require significantly more work and headache.”</li>
<li>“Not only is that painful to code, but it also requires broad and deep knowledge of inconsequential things.”</li>
<li>“FRP makes tasks considerably easier by taking care of the messy .how. of events, display, and updates.”</li>
</ol>
<h4 id="q2.-where-my-project-idea-came-from-what-inspired-me"><span class="header-section-number">8.1.2.2</span> Q2. Where my Project Idea came from (what inspired me)?</h4>
<ul>
<li>The pain of coding and writing GUIs in PyQt4 while at my last job at Altran</li>
<li>The joys of coding in Haskell</li>
<li>The pain of writing GUIs in Haskell</li>
<li>The joys of coding and writing GUIs in Elm!</li>
</ul>
<h4 id="q3.-what-are-my-concerns"><span class="header-section-number">8.1.2.3</span> Q3. What are my concerns?</h4>
<ol type="1">
<li>Difficulty procuring programmers (users) – specifically those that meet my criteria of not having used a declarative programming language.</li>
<li>Difficulty procuring programmers working in a team</li>
<li>The complexity/scope of the project – is it enough for a FYP; is it too much?</li>
<li>Looking at the production of User Interfaces using a programming language, there are many variables – how will I devise an experiment to minimise this and isolate a variable so that I can make some causal/correlational conclusions?</li>
<li>Concern regarding the dependency of a subsequent part of the project on a previous step – this is inherent of all projects, though.</li>
</ol>
<h2 id="experimental-design"><span class="header-section-number">8.2</span> Experimental design</h2>
<h3 id="am-in-stv"><span class="header-section-number">8.2.1</span> 30/10/2013 @ 9:15 am in STV</h3>
<h4 id="individual-meeting-after-proposal-hand-in"><span class="header-section-number">8.2.1.1</span> Individual Meeting after Proposal hand-in</h4>
<p>Our discussion centered around the direction I wish to take following my Project Proposal.</p>
<h5 id="ab-testing-of-the-language-with-the-same-ide"><span class="header-section-number">8.2.1.1.1</span> AB Testing of the language with the same IDE</h5>
<p>The primary direction I mentioned (as echoed in my Proposal) was doing AB testing of Elm vs. another language (e.g. JavaScript) (i.e. the language is the dependent variable) using the same Concurrent FRP IDE (the independent variable).</p>
<h5 id="test-just-the-paradigm"><span class="header-section-number">8.2.1.1.2</span> Test just the paradigm</h5>
<p>He also suggested a potential experiment to test just the paradigm, eliminating the IDE from the experiment above. Perhaps for a Pilot study.</p>
<h5 id="experiment-process"><span class="header-section-number">8.2.1.1.3</span> Experiment process</h5>
<ol type="1">
<li>Study question (e.g. Is it easy?)</li>
<li>Measurement concept (e.g. “Easy”)</li>
<li>Operationalisation – taking a measurement concept and mapping it to something concrete (e.g. if completing a pre-defined task the user must complete takes <span class="math"> &lt; 5</span> steps, it is ‘easy’ – we can then compare instances of these studies given our definition of easy). This is much like mapping a design to an implementation, and there is a risk of losing information, or ending up with a mismatched concrete instance that does not represent the concept we wish to convey.</li>
<li>Do another operationalisation of our measurement concept – this allows us to get a different perspective of the same concept. (e.g. if total length of pauses during a 1 hour experiment is <span class="math"> &lt; 10</span> minutes, it is ‘easy’). We do this to get ‘coverage’ of the measurement concept. It is a form of cross validation. If we see an overlap in the correlational results after analysis, we can make a stronger assertion that e.g. “language A is easier than language B.”. The idea I am describing here is methodological decision-making.</li>
<li>Predict what will be the likely results of our experiments on the operationalised measurements. This is “feed forward validation”.</li>
<li>Do the experiement.</li>
<li>Analyse the data. See if the data has patterns that correlate with the assertion I wish to make. I will be representing the raw data in some outcome measure – that is turning the raw data into a set of (or a single) value for comparison.</li>
<li>Does the data answer the study question I set out to ask? This is now “feed backwards validation”.</li>
<li>Write-up including the ‘nitty-gritty’ of the user study, and a statement like “Given our definition of easy, our multiple operationalisations of the concept of easy show that this is infact objectively true/false”.</li>
</ol>
<h5 id="pilots"><span class="header-section-number">8.2.1.1.4</span> Pilots</h5>
<p>We also spoke about ideas for pilot studies – asking “What might be surprising insights into declarative programming languages for User Interface Design – the case of Elm?”.</p>
<p>Speak-aloud protocols where you prompt/facilitate the user to say what is on their mind when that e.g. pause for more than 10 seconds – a measurement I set out to look for during an experiment.</p>
<p>I might ask</p>
<ul>
<li><blockquote>
<p>I notice you have paused for at least 10 seconds – why did you?</p>
</blockquote></li>
<li><blockquote>
<blockquote>
<p>I thought the code would do X, but it did Y.</p>
</blockquote>
</blockquote></li>
<li><blockquote>
<p>Why did you think it would do X?</p>
</blockquote></li>
<li><blockquote>
<blockquote>
<p>…</p>
</blockquote>
</blockquote></li>
</ul>
<p>I must ask the participant questions designed in a way that they are not leading.</p>
<p>Leon suggested I gather a rich data set, as it’s difficult to take notes AND prompt the user during an experiment. SO difficult. Perhaps record video.</p>
<h4 id="actions-for-next-meeting"><span class="header-section-number">8.2.1.2</span> Actions for next meeting</h4>
<p>Devise a Pilot study, answering these 3 questions:</p>
<ol type="1">
<li>What might I ask people to do?</li>
<li>How will I gather data?</li>
<li>How will I analyse the data?</li>
</ol>
<p>Also see paper Leon will send me on “Thematic analysis &amp; Psychology”</p>
<h3 id="wed-mar-25-1430-gmt-2014"><span class="header-section-number">8.2.2</span> Wed Mar 25 14:30 GMT 2014</h3>
<p>(Several meetings undocumented)</p>
<p><strong>TODO</strong>: Refer to notes in Diary for previous entries.</p>
<h4 id="progress-since-last-meeting"><span class="header-section-number">8.2.2.1</span> Progress since last meeting</h4>
<p>Discussed findings from analysis of pilot study</p>
<h5 id="observation-1"><span class="header-section-number">8.2.2.1.1</span> Observation 1</h5>
<ul>
<li><p>Prompting <em>“What are you thinking about?”</em> etc. seemed to place additional cognitive load on the user as they spent longer resuming than when not prompted. This caused noise in assessing the actual cognitive load incurred during the completion of the <strong>task</strong>. Were the signs of struggling/undergoing difficulty due to simply not understanding the language, or were they due to the difficulty of the task?</p></li>
<li><p>In particular, the majority of instances where the users paused turned out to be confusion as to the semantics &amp; syntax of the language.</p></li>
</ul>
<h5 id="model-adjustment-1"><span class="header-section-number">8.2.2.1.2</span> Model Adjustment 1</h5>
<ul>
<li>Add tooltips that appear as the user places the keyboard cursor to the right of a token in the language.</li>
</ul>
<h5 id="observation-2"><span class="header-section-number">8.2.2.1.3</span> Observation 2</h5>
<ul>
<li>Sifting through 1-hour+ of video data capture for incidences of cognitive load is <em>HARD!</em>. Is there some programmatic way of narrowing the video data to points of interest?</li>
</ul>
<h5 id="model-adjustment-2"><span class="header-section-number">8.2.2.1.4</span> Model Adjustment 2</h5>
<ul>
<li><p>Track the user mouse and keyboard movements in a 3-tuple: <code>(Time t, (Mouse.x,   Mouse.y), Keypress k)</code></p></li>
<li><p>It doesn’t have to be implemented this way. I could extend <strong>Model Adjustment 1</strong> to define blocks of code as tokens in themselves, and capture how long the cursor is static on that particular token.</p></li>
<li><p>Leon suggested a further refinement of this idea in order to further narrow the data (in fact, just capturing mouse &amp; keyboard movements will result in an explosion of the volume of data – countrary to what I intend to achieve). His refinement was to define regions of interest in the code pane, and <em>only when the mouse/key cursor is in the region, do I capture data</em>.</p></li>
<li><p>Use the <code>if cursor in region then log (Time t, (Mouse.x, Mouse.y), Keypress   k)</code> functionality as a <em>lens</em> to focus on significant portions of video capture.</p></li>
</ul>
<h4 id="further-discussion"><span class="header-section-number">8.2.2.2</span> Further discussion</h4>
<p>We then discussed some questions that might lead my direction of study in the next steps of my research:</p>
<ul>
<li><p>Is the mouse/cursor position a proxy for someone’s attention as they carry out the task?</p></li>
<li><p>Often when I’m coding I’ll leave the cursor where it is but think about other regions of code. I don’t necessarily move the keyboard/mouse cursor to the section of code I’m thinking about. Instead, I use it as a ‘bookmark’ to track what I’m currently implementing, and may scroll around to other parts.</p></li>
</ul>
<h4 id="we-also-discussed"><span class="header-section-number">8.2.2.3</span> We also discussed…</h4>
<p>The result of the dissertation will be a list of observed cognitive easing/loading that each language produces for users, much like an advantage/disadvantage comparison:</p>
<table>
<col style="width: 16%" /><col style="width: 16%" /><thead>
<tr class="header">
<th style="text-align: left;">Elm</th>
<th style="text-align: left;">JavaScript</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">+ …</td>
<td style="text-align: left;">+ …</td>
</tr>
<tr class="even">
<td style="text-align: left;">+ …</td>
<td style="text-align: left;">- …</td>
</tr>
<tr class="odd">
<td style="text-align: left;">- …</td>
<td style="text-align: left;">- …</td>
</tr>
<tr class="even">
<td style="text-align: left;">- …</td>
<td style="text-align: left;">+ …</td>
</tr>
<tr class="odd">
<td style="text-align: left;">+ …</td>
<td style="text-align: left;">_</td>
</tr>
</tbody>
</table>
<h4 id="actions"><span class="header-section-number">8.2.2.4</span> Actions</h4>
<ol type="1">
<li><p>Design a task in JavaScript to go inside this adjusted model (incorporating Model Adjustment 1 and 2).</p>
<p>This will require a degree of <em>“implementation juggling”</em> in order to find a balance of code-length/difficulty over the same task in Elm in such a way that is not creating noise in the thing being studied: Cognitive load.</p>
<p>Keep the reactivity constant, compare the differences in ease between JS and Elm.</p></li>
<li><p>If time available, run another Pilot study on this task + adjusted model</p></li>
</ol>
<h3 id="tue-apr-1-143000-bst-2014"><span class="header-section-number">8.2.3</span> Tue Apr 1 14:30:00 BST 2014</h3>
<p>Discussed progress made and what hypotheses to form that may usefully model cognitive load.</p>
<h4 id="progress-since-last-meeting-1"><span class="header-section-number">8.2.3.1</span> Progress since last meeting</h4>
<figure>
<img src="ide-extensions.png" alt="Extensions made to the Elm IDE" /><figcaption>Extensions made to the Elm IDE</figcaption>
</figure>
<p>I have implemented full-screen mouse tracking that stores to a database a tuple:</p>
<pre><code>(t, (x, y))</code></pre>
<p>for every mouse move, producing a list in JSON (so it’s more like <code>{{uniq-userid: {125125, (67, 321)}}, {uniq-userid: {125126, (67, 322)}} ...}</code>)</p>
<p>I am ready to demo this (See Action 1.)</p>
<p>The only issue worth tweaking is that user activity data is captured separately from the error output, so I will need to collate the data afterwards or find some way to feed it into the same data store.</p>
<h4 id="meeting-discussion"><span class="header-section-number">8.2.3.2</span> Meeting Discussion</h4>
<p>2 Hypotheses</p>
<ol type="1">
<li><p>Why the regions (<em>see green boxes in figure above</em>) I define in the code (to mouse-track e.g.) are meaningful</p></li>
<li><p>Frequency of semantically or syntactically incorrect errors made will differ as a function of the language under study</p></li>
</ol>
<p>These need narrowing as they are too broad to test. Explode them into multiple, tighter hypotheses.</p>
<p>They are <em>valid</em> because they are <em>well-founded</em> – i.e. I have good reason to believe that # of errors made is an indication of cognitive load. I have good reason to believe that the selected regions will have more mouse activity (or whatever activity I suspect indicates higher cognitive load) as they are harder regions of code OR they pertain to achieving the set task.</p>
<h4 id="actions-1"><span class="header-section-number">8.2.3.3</span> Actions</h4>
<ol type="1">
<li><p>Refine Mouse logging</p>
<ol type="1">
<li><strong>DONE</strong> Make it so that I can run arbitrary Elm code in the editor via a fileOpen operation</li>
<li><strong>DONE</strong> Make an Elm file that logs mouse movements ready to be loaded into the editor (See )</li>
<li><strong>DONE</strong> Load it into the editor and test it uploads to Firebase</li>
<li><strong>DONE</strong> Modify Generate.hs (See )</li>
</ol>
<table class="sourceCode haskell numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="kw">case</span> (Elm.compile elmSrc) <span class="kw">of</span> 
    <span class="dt">Left</span> jsSrc <span class="ot">-&gt;</span> <span class="fu">...</span>
    <span class="dt">Right</span> _ <span class="ot">-&gt;</span> error <span class="st">&quot;blah&quot;</span></code></pre></td></tr></table>
<p>So that when we get an error, we timestamp and append it to a log file so this can later be collated with the Firebase to determine when errors were made</p>
<p>I’ll need to insert a layer between <code>compile :: Snap()</code> and <code>serveHtml ::    MonadSnap m =&gt; H.Html -&gt; m ()</code> that performs the logging. It will have type signature <code>TypedHtml -&gt; H.Html</code></p>
<p>See the functions <code>compile</code> and <code>serveHtml</code> in Server.hs (See ).</p>
<ol start="5" type="1">
<li>Make it so I can define regions in the mouse tracking – i.e. ONLY within a defined region is the mouse movement tracked e.g. <code>if mouse(x,y) in    some2by2Square then Just mouse(x,y) else Nothing</code></li>
</ol>
<p>See <a href="">https://github.com/spanners/laska/blob/master/Signals.elm</a></p></li>
<li><strong>DONE</strong> Demo to supervisor
<ol type="1">
<li>Install on VPS (See )</li>
<li>Run these:</li>
</ol>
<table class="sourceCode bash numberLines"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="kw">git</span> clone https://github.com/spanners/elm-lang.org
<span class="kw">cd</span> elm-lang.org
<span class="kw">cabal</span> install --bindir=.</code></pre></td></tr></table></li>
<li><p><strong>DONE</strong> Design a task in JS and Elm</p></li>
<li>Define regions to select for logging activity. Why? Because:
<ul>
<li>Complex logic in code, OR</li>
<li>Relevant to task</li>
<li>Captures Thrash (keep on going over the same thing, e.g.). Errors made also captures thrash!</li>
</ul></li>
<li><p><strong>DONE</strong> Determine what to do with mouse (for example) data.</p></li>
</ol>
<h3 id="tuesday-apr-8-143000-bst-2014"><span class="header-section-number">8.2.4</span> Tuesday Apr 8 14:30:00 BST 2014</h3>
<p>What makes code difficult to understand and work with?</p>
<ul>
<li>Bit twiddling?</li>
<li>Declaring and defining simultaneously?</li>
<li>Compound if/then/else statements?</li>
</ul>
<p><em>[Programming is] manipulating symbols blindly</em> ~ Bret Victor</p>
<p>Do a 2×2 study, defining regions in the code monitoring mouse clicks. Regions can either be simple/hard in complexity (exhibiting/not-exhibiting one of the above ‘difficult’ properties). Or code can be task-oriented or not, that is <em>the code does/does not need to be changed to achieve the completed task set for the user</em>:</p>
<table>
<caption>2 × 2 study between-subjects </caption>
<col style="width: 22%" /><col style="width: 25%" /><tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Elm</strong></td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;">Simple/Task</td>
<td style="text-align: left;">Hard/Task</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simple/Not-Task</td>
<td style="text-align: left;">Hard/Not-Task</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>JavaScript</strong></td>
<td style="text-align: left;">-</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simple/Task</td>
<td style="text-align: left;">Hard/Task</td>
</tr>
<tr class="even">
<td style="text-align: left;">Simple/Not-Task</td>
<td style="text-align: left;">Hard/Not-Task</td>
</tr>
</tbody>
</table>
<h4 id="study-method"><span class="header-section-number">8.2.4.1</span> Study method</h4>
<p>Look at total and/or mean time in each of these areas for comparison.</p>
<p>My study will be <strong>between-subjects</strong> instead of within-subjects.</p>
<p>That is, I will study <em>different users</em> for different languages. If a user has completed the task in Elm, I can not have them complete the task in JavaScript, and vice-versa.</p>
<p>I will necessarily make a compromise here:</p>
<p>Between-subjects:</p>
<ul>
<li><p>I lose the ability to keep programmer competence as constant, thus it is a confounding variable</p></li>
<li><p>I gain the ability to ignore learned-experience in completing the task – the participant is different every time so will not have done this task before, thus this is not a confounding variable.</p></li>
</ul>
<p>Within-subjects is the converse of the above methodological properties</p>
<h4 id="actions-2"><span class="header-section-number">8.2.4.2</span> Actions</h4>
<ol type="1">
<li><p><strong>DONE</strong> Reorder divs so embedded div is on top of editor div.</p>
<p>This turned out (I am fairly certain) to be due to codemirror.js binding mouse clicks. It was solved by using Elm’s <code>Mouse.isDown</code>. Using <code>Mouse.isDown</code> has the added benefit of tracking mouse selects and drags, because it logs <code>(x,y)</code> when the mouse is down and <code>(x,y)</code> again when it is up.</p></li>
<li><p><strong>DONE</strong> Create a task that features <em>Hard/Simple x Task/Not-task</em> (See )</p></li>
<li><p><del>Implement <em>Region filtering</em> functionality so mouse activity is only logged when the clicks occur within defined region(s)</del></p>
<p>I have instead defined bounding boxes that pertain to the regions I want to track as a mouse-data filter – that is, I capture all click data for the whole frame, and then filter it by comparing x,y co-ordinates with my bounding boxes. If it’s in the box, keep it, otherwise discard.</p></li>
<li><p><strong>DONE</strong> Integrate JS task into IDE</p></li>
<li><p><strong>DONE</strong> Perform pilot study</p></li>
<li><p><strong>WIP</strong> Visualise mouse data</p></li>
</ol>
<h1 id="implementation-and-testing"><span class="header-section-number">9</span> Implementation and Testing</h1>
<p>This is the chapter in which you review the implementation and testing decisions and issues, and critique these processes. Code can be output inline using <code>some code</code>. For example, this code is inline: <code>public static int example = 0;</code> (I have used the character | as a delimiter, but any non-reserved character not in the code text can be used.) Code snippets can be output using the environment with the code given in the environment. For example, consider listing 5.1, below. Listing 5.1: Example code</p>
<p>Code listings are produced using the package “Listings”. This has many useful options, so have a look at the package documentation for further ideas.</p>
<h1 id="results"><span class="header-section-number">10</span> Results</h1>
<h3 id="tue-apr-15-155038-bst-2014"><span class="header-section-number">10.0.1</span> Tue Apr 15 15:50:38 BST 2014</h3>
<p>Operationalisation of thrash (the concept), i.e. cementing the concept by a metric that models cognitive load (does it? we don’t know – further work after the analysis of this may determine if it is a plausible indicator of cognitive load)</p>
<p>Leon suggested an improvement over this experimental method is to take people who are new, and train them up either in JS or Elm, and then run the same task. That way, their level of ability is comparable. (New as in never having used JS or Elm)</p>
<p>My current method creates quite a bit of noise in the data, because I rely on self-reported level of expertise in JS/Functional languages. I don’t know how to modify the data to account for this. I could group the analyses into categories? I.e those who reported being experts at JS, those who reported never having used it, those who reported being experts in at least one FP language, and those who reported being new.</p>
<p>Talk about “phases” in a programmer’s activities during task-completion:</p>
<p>(Not necessarily distinct and in sequence — more often interleaved)</p>
<ol type="1">
<li>Familiarisation – Where is the bit I need to change?</li>
<li>Narrowing in on the task once discovered – Oh I need to change <code>X</code>, but how?</li>
<li>Solved task</li>
<li>Playing (?)</li>
</ol>
<h4 id="mention-the-ways-in-which-the-study-is-flawed"><span class="header-section-number">10.0.1.1</span> Mention the ways in which the study is flawed:</h4>
<ol type="1">
<li>Self-reported expertise</li>
<li>Self-reported task completion</li>
<li>No way to be sure which error log pertains to which compile</li>
<li>Unique participant ID per Surveymonkey</li>
<li>Surveymonkey has taken my data hostage</li>
<li>window dimensions?!</li>
<li>Syntax reference 404</li>
<li>I did not capture their code solution, so relied on trust</li>
</ol>
<h4 id="results-1"><span class="header-section-number">10.0.1.2</span> Results</h4>
<ol type="1">
<li>Describe data collected</li>
<li>How it was analysed (I aggregated regions and looked at number of clicks per region (Hard/Task, Hard/Not-Task, Simple/Task, Simple/Not-Task)*(Elm, JavaScript))</li>
<li>Presentation of data (summary means std dev.)
<ol type="1">
<li><span class="math"><em>χ</em><sup>2</sup></span> frequency analyses</li>
<li>2 × 2 × 2 making 8 cells. My expected is an even distribution of clicks in each category, i.e. if I have 80 clicks in total across all groups, I expect to find 10 in each cell if there is no correlation.</li>
</ol></li>
</ol>
<table>
<caption>Session time and clicks per session for Elm task</caption>
<col style="width: 16%" /><col style="width: 16%" /><thead>
<tr class="header">
<th style="text-align: left;">Time (min)</th>
<th style="text-align: left;">Clicks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">38.717217</td>
<td style="text-align: left;">183</td>
</tr>
<tr class="even">
<td style="text-align: left;">8.034583</td>
<td style="text-align: left;">130</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7.878533</td>
<td style="text-align: left;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">23.672500</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">29.754533</td>
<td style="text-align: left;">391</td>
</tr>
<tr class="even">
<td style="text-align: left;">14.993517</td>
<td style="text-align: left;">78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48.960367</td>
<td style="text-align: left;">769</td>
</tr>
<tr class="even">
<td style="text-align: left;">6.354050</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7.878533</td>
<td style="text-align: left;">39</td>
</tr>
<tr class="even">
<td style="text-align: left;">29.698267</td>
<td style="text-align: left;">501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40.302217</td>
<td style="text-align: left;">803</td>
</tr>
<tr class="even">
<td style="text-align: left;">12.319317</td>
<td style="text-align: left;">65</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17.106933</td>
<td style="text-align: left;">79</td>
</tr>
<tr class="even">
<td style="text-align: left;">12.958300</td>
<td style="text-align: left;">119</td>
</tr>
</tbody>
</table>
<p>Instead of <span class="math"><em>χ</em><sup>2</sup></span>, consider just using multiple regression with dummy variables (binary predictors) (See Table )</p>
<table>
<caption>Multiple regression with dummy variables (d1, d2..) (binary predictors) </caption>
<col style="width: 14%" /><col style="width: 9%" /><col style="width: 12%" /><col style="width: 9%" /><col style="width: 13%" /><col style="width: 13%" /><col style="width: 13%" /><col style="width: 13%" /><thead>
<tr class="header">
<th style="text-align: left;">Condition</th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>1</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>2</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>3</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>4</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>5</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>6</sub></span></th>
<th style="text-align: left;"><span class="math"><em>d</em><sub>7</sub></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">relevant × hard × Elm</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">relevant × hard × JS</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">relevant × easy × Elm</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">relevant × easy × JS</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">irrelevant × hard × Elm</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">irrelevant × hard × JS</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">irrelevant × easy × Elm</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">irrelevant × easy × JS</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
<ul>
<li>The <span class="math"><em>d</em><sub><em>n</em></sub></span> in the top row are the dummy variables, the values are the codes you assign them</li>
<li>There are <span class="math"><em>n</em> − 1</span> dummy variabes; one group is coded as all zeros – that’s your reference group</li>
<li>Why <span class="math"><em>n</em> − 1</span>? If there are 8 dummy codes, there are the same number of variables as conditions. the model’s fully saturated and there are no degrees of freedom
<ul>
<li>Similar to <span class="math"><em>x</em><sub>1</sub> = 2, <em>x</em><sub>2</sub> = 4, <em>x</em><sub>3</sub> = 1</span>, and <span class="math"><em>y</em> = 2</span>. then trying to solve for <span class="math"><em>y</em></span></li>
</ul></li>
</ul>
<p><strong>This is the chapter in which you review the outcomes, and critique the outcomes process.</strong></p>
<p><strong>You may include user evaluation here too.</strong></p>
<h1 id="conclusions"><span class="header-section-number">11</span> Conclusions</h1>
<p>This is the chapter in which you review the major achievements in the light of your original objectives, critique the process, critique your own learning and identify possible future work.</p>
<div class="references">
<h1><span class="header-section-number">11</span> Bibliography</h1>
<p>Bath, U. (2013) ‘Research ethics framework checklist’, [online] Available from: <a href="http://www.bath.ac.uk/research/pdf/ethics/EIRA1ethicsform.doc">http://www.bath.ac.uk/research/pdf/ethics/EIRA1ethicsform.doc</a>.</p>
<p>Braun, V. and Clarke, V. (2006) ‘Using thematic analysis in psychology’, <em>Qualitative Research in Psychology</em>, 3(2), pp. 77–101, [online] Available from: <a href="http://www.tandfonline.com/doi/abs/10.1191/1478088706qp063oa">http://www.tandfonline.com/doi/abs/10.1191/1478088706qp063oa</a>.</p>
<p>Czaplicki, E. (2013a) ‘Elm 0.10’, [online] Available from: <a href="http://elm-lang.org/blog/announce/0.10.elm">http://elm-lang.org/blog/announce/0.10.elm</a>.</p>
<p>Czaplicki, E. (2012) ‘Elm: Concurrent FRP for Functional GUIs’,</p>
<p>Czaplicki, E. (2013b) ‘What is functional reactive programming?’, [online] Available from: <a href="http://elm-lang.org/learn/What-is-FRP.elm">http://elm-lang.org/learn/What-is-FRP.elm</a> (Accessed 1 October 2013).</p>
<p>Gopher, D. and Braune, R. (1984) ‘On the psychophysics of workload: Why bother with subjective measures?’, <em>Human Factors: The Journal of the Human Factors and Ergonomics Society</em>, SAGE Publications, 26(5), pp. 519–532.</p>
<p>Hertzum, M. and Jacobsen, N. E. (2001) ‘The evaluator effect: A chilling fact about usability evaluation methods’, <em>International Journal of Human-Computer Interaction</em>, Taylor &amp; Francis, 13(4), pp. 421–443.</p>
<p>Hunt, A. and Thomas, D. (1999) <em>The pragmatic programmer: from journeyman to master</em>, Boston, MA, USA, Addison-Wesley Longman Publishing Co., Inc.</p>
<p>Khawaja, M. A., Ruiz, N. and Chen, F. (2008) ‘Think before you talk: An empirical study of relationship between speech pauses and cognitive load’, In <em>Proceedings of the 20th australasian conference on computer-human interaction: Designing for habitus and habitat</em>, OZCHI ’08, New York, NY, USA, ACM, pp. 335–338, [online] Available from: <a href="http://doi.acm.org/10.1145/1517744.1517814">http://doi.acm.org/10.1145/1517744.1517814</a>.</p>
<p>Lopez, T., Petre, M. and Nuseibeh, B. (2012) ‘Thrashing, tolerating and compromising in software development’, In Jing, Y. (ed.), <em>Psychology of Programming Interest Group Annual Conference (PPIG-2012)</em>, London Metropolitan University, UK, London Metropolitan University, pp. 70–81.</p>
<p>Martin, R. C. (2008) <em>Clean code: A handbook of agile software craftsmanship</em>, 1st ed. Upper Saddle River, NJ, USA, Prentice Hall PTR.</p>
<p>McKay, F. and K<span>ö</span>lling, M. (2012) ‘Evaluation of subject-specific heuristics for initial learning environments: A pilot study’, In <em>Proceedings of the 24th Psychology of Programming Interest Group Annual Conference 2012</em>, London Metropolitan University, pp. 128–138.</p>
<p>Perlis, A. J. (1982) ‘Epigrams on programming’, <em>SIGPLAN Notices</em>, 17(9), pp. 7–13.</p>
<p>Puerta, A. R. (1997) ‘A Model-Based Interface Development Environment’, <em>IEEE Softw.</em>, Los Alamitos, CA, USA, IEEE Computer Society Press, 14(4), pp. 40–47, [online] Available from: <a href="http://dx.doi.org/10.1109/52.595902">http://dx.doi.org/10.1109/52.595902</a>.</p>
<p>Victor, B. (2012) ‘Inventing on principle’, In <em>Proceedings of the canadian university software engineering conference (CUSEC)</em>, [online] Available from: <a href="http://vimeo.com/36579366">http://vimeo.com/36579366</a> (Accessed 15 March 2014).</p>
<p>Yates, R. (2012) ‘Conducting field studies in software engineering: An experience report’, In Jing, Y. (ed.), <em>Psychology of Programming Interest Group Annual Conference (PPIG-2012)</em>, London Metropolitan University, UK, London Metropolitan University, pp. 82–85.</p>
</div>
<h1 id="appendices">Appendices</h1>
<h1 id="appendix-a" class="unnumbered">Appendix A</h1>
<h2 id="design-diagrams">Design Diagrams </h2>
<h1 id="appendix-b" class="unnumbered">Appendix B</h1>
<h2 id="raw-results-output">Raw results output</h2>
<h3 id="firebase-mouseclick-data.json">firebase-mouseclick-data.json </h3>
<table class="sourceCode json numberLines" include="code/firebase-mouseclick-data.json"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre></td><td class="sourceCode"><pre><code class="sourceCode json">{
  <span class="dt">&quot;js&quot;</span> : {
    <span class="dt">&quot;12&quot;</span> : {
      <span class="dt">&quot;-JKVwXgnfg4POT9MArjy&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397490853983</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="dv">0</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="dv">0</span>
      },
      <span class="dt">&quot;-JKVwXl8I_bLZNqxP36c&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397490854551</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="dv">444</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="dv">417</span>
      },
      <span class="dt">&quot;-JKVwXj0LD-uRKDsT2Om&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397490854503</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="dv">444</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="dv">417</span>
      }
    }
  },
  <span class="dt">&quot;elm&quot;</span> : {
    <span class="dt">&quot;33&quot;</span> : {
      <span class="dt">&quot;-JKRgqJIRPH2EG-edZb5&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397419631953</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="fl">249.59999084472656</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="fl">48.79999923706055</span>
      },
      <span class="dt">&quot;-JKRhRQi31pr9AP1p1Rr&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397419787709</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="fl">294.3999938964844</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="fl">152.8000030517578</span>
      },
      <span class="dt">&quot;-JKRffOszNGfgwNdnO_X&quot;</span> : {
        <span class="dt">&quot;t&quot;</span> : <span class="dv">1397419324585</span>,
        <span class="dt">&quot;y&quot;</span> : <span class="dv">608</span>,
        <span class="dt">&quot;x&quot;</span> : <span class="fl">346.3999938964844</span>
      }
    }
  }
}</code></pre></td></tr></table>
<h3 id="error_log.json">error_log.json </h3>
<table class="sourceCode json numberLines" include="code/error_log.json"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="sourceCode"><pre><code class="sourceCode json">{
   <span class="dt">&quot;2014-04-11 21:14:32.141743994+01:00&quot;</span>:{
      <span class="dt">&quot;Parse error at (line 37, column 44):&quot;</span>,
      <span class="dt">&quot;unexpected &#39;a&#39;&quot;</span>,
      <span class="dt">&quot;expecting \&quot;{-\&quot;, \&quot; \&quot; or end of input&quot;</span>
   },
   <span class="dt">&quot;2014-04-11 21:35:41.694436974+01:00&quot;</span>:{
      <span class="dt">&quot;Type error on line 27, column 16 to 77:&quot;</span>,
      <span class="dt">&quot;        (min (max x (-hHeight)) hHeight,&quot;</span>,
      <span class="dt">&quot;         (min (max y (-hWidth)),hWidth))&quot;</span>,
      <span class="dt">&quot;&quot;</span>,
      <span class="dt">&quot;   Expected Type: Float&quot;</span>,
      <span class="dt">&quot;     Actual Type: (Float -&gt; Float, Float)&quot;</span>
   },
   <span class="dt">&quot;2014-04-12 00:19:14.945129550+01:00&quot;</span>:{
      <span class="dt">&quot;Parse error at (line 1, column 1):&quot;</span>,
      <span class="dt">&quot;unexpected \&quot;&lt;\&quot;&quot;</span>,
      <span class="dt">&quot;expecting reserved word &#39;module&#39;, reserved word &#39;import&#39; </span>
<span class="dt">	      or at least one datatype or variable definition&quot;</span>
   },
   <span class="dt">&quot;2014-04-12 00:19:21.553633974+01:00&quot;</span>:{
      <span class="dt">&quot;Parse error at (line 1, column 1):&quot;</span>,
      <span class="dt">&quot;unexpected \&quot;/\&quot;&quot;</span>,
      <span class="dt">&quot;expecting reserved word &#39;module&#39;, reserved word &#39;import&#39; </span>
<span class="dt">	      or at least one datatype or variable definition&quot;</span>
   },
   <span class="dt">&quot;2014-04-12 00:19:27.053901481+01:00&quot;</span>:{
      <span class="dt">&quot;Parse error at (line 1, column 1):&quot;</span>,
      <span class="dt">&quot;unexpected \&quot;/\&quot;&quot;</span>,
      <span class="dt">&quot;expecting reserved word &#39;module&#39;, reserved word &#39;import&#39; </span>
<span class="dt">	      or at least one datatype or variable definition&quot;</span>
   },
}</code></pre></td></tr></table>
<h1 id="appendix-c" class="unnumbered">Appendix C</h1>
<h2 id="code">Code</h2>
<ul>
<li><p>All code available here: <a href="">https://github.com/spanners/elm-lang.org</a>.</p>
<ul>
<li>This is a modifed version of Evan Czaplicki's elm-lang.org code, available here: <a href="">https://github.com/elm-lang/elm-lang.org</a></li>
</ul></li>
<li>Elm task here: <a href="">http://mouth.crabdance.com:8000/edit/task/MovingBox.elm</a></li>
<li><p>Javascript task here: <a href="">http://mouth.crabdance.com:8000/_edit/task/MovingBox.js</a></p></li>
</ul>
<h3 id="license">LICENSE</h3>
<pre include="code/LICENSE"><code>Copyright (c) 2012-2013 Evan Czaplicki

All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * Neither the name of Evan Czaplicki nor the names of other
      contributors may be used to endorse or promote products derived
      from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
&quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
</code></pre>
<h3 id="install_elm.sh">install_elm.sh </h3>
<table class="sourceCode bash numberLines" include="code/install_elm.sh"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="sourceCode"><pre><code class="sourceCode bash"><span class="co">#!/bin/bash</span>

<span class="kw">sudo</span> apt-get install libgl1-mesa-dev libglc-dev freeglut3-dev 
<span class="kw">sudo</span> apt-get install libedit-dev libglw1-mesa libglw1-mesa-dev
<span class="kw">sudo</span> apt-get install ghc
<span class="kw">wget</span> http://www.haskell.org/ghc/dist/7.6.3/ghc-7.6.3-src.tar.bz2
<span class="kw">tar</span> xjf ghc-7.6.3-src.tar.bz2
<span class="kw">cd</span> ghc-7.6.3/mk
<span class="kw">cp</span> build.mk.sample build.mk
<span class="kw">sed</span> -i <span class="st">&#39;s/^#BuildFlavour = quick/BuildFlavour = quick/&#39;</span> build.mk
<span class="kw">cd</span> ..
<span class="kw">./configure</span>
<span class="kw">make</span> -j 8
<span class="kw">sudo</span> make install
<span class="kw">cd</span>
<span class="ot">platform=</span><span class="st">&quot;2013.2.0.0/haskell-platform-2013.2.0.0.tar.gz&quot;</span>
<span class="kw">wget</span> <span class="st">&quot;http://lambda.haskell.org/platform/download/&quot;</span><span class="ot">$platform</span>
<span class="kw">tar</span> xzvf haskell-platform-2013.2.0.0.tar.gz
<span class="kw">cd</span> haskell-platform-2013.2.0.0
<span class="kw">./configure</span>
<span class="kw">make</span>
<span class="kw">sudo</span> make install
<span class="kw">cabal</span> update
<span class="kw">cabal</span> install cabal-install
<span class="kw">cabal</span> install elm
<span class="kw">cabal</span> install elm-server
<span class="kw">exit</span> 0</code></pre></td></tr></table>
<h3 id="server.hs">Server.hs </h3>
<table class="sourceCode haskell numberLines" include="code/server/Server.hs"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="ot">{-# OPTIONS_GHC -W #-}</span>
<span class="ot">{-# LANGUAGE OverloadedStrings, DeriveDataTypeable #-}</span>
<span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Monoid</span> (mempty)
<span class="kw">import qualified</span> <span class="dt">Data.ByteString</span> <span class="kw">as</span> <span class="dt">BS</span>
<span class="kw">import qualified</span> <span class="dt">Data.ByteString.Char8</span> <span class="kw">as</span> <span class="dt">BSC</span>
<span class="kw">import qualified</span> <span class="dt">Elm.Internal.Utils</span> <span class="kw">as</span> <span class="dt">Elm</span>
<span class="kw">import </span><span class="dt">Control.Applicative</span>
<span class="kw">import </span><span class="dt">Control.Monad.Error</span>

<span class="kw">import </span><span class="dt">Text.Blaze.Html5</span> ((!))
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5</span> <span class="kw">as</span> <span class="dt">H</span>
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5.Attributes</span> <span class="kw">as</span> <span class="dt">A</span>
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html.Renderer.Utf8</span> <span class="kw">as</span> <span class="dt">BlazeBS</span>
<span class="kw">import </span><span class="dt">Text.Regex</span>

<span class="kw">import </span><span class="dt">Snap.Core</span>
<span class="kw">import </span><span class="dt">Snap.Http.Server</span>
<span class="kw">import </span><span class="dt">Snap.Util.FileServe</span>
<span class="kw">import </span><span class="dt">System.Console.CmdArgs</span>
<span class="kw">import </span><span class="dt">System.FilePath</span> <span class="kw">as</span> <span class="dt">FP</span>
<span class="kw">import </span><span class="dt">System.Process</span>
<span class="kw">import </span><span class="dt">System.Directory</span>
<span class="kw">import </span><span class="dt">GHC.Conc</span>

<span class="kw">import qualified</span> <span class="dt">Elm.Internal.Paths</span> <span class="kw">as</span> <span class="dt">Elm</span>
<span class="kw">import qualified</span> <span class="dt">Generate</span>
<span class="kw">import qualified</span> <span class="dt">Editor</span>

<span class="kw">data</span> <span class="dt">Flags</span> <span class="fu">=</span> <span class="dt">Flags</span>
  {<span class="ot"> port ::</span> <span class="dt">Int</span>
  } <span class="kw">deriving</span> (<span class="dt">Data</span>,<span class="dt">Typeable</span>,<span class="dt">Show</span>,<span class="dt">Eq</span>)

<span class="ot">flags ::</span> <span class="dt">Flags</span>
flags <span class="fu">=</span> <span class="dt">Flags</span>
  { port <span class="fu">=</span> <span class="dv">8000</span> <span class="fu">&amp;=</span> help <span class="st">&quot;set the port of the server&quot;</span>
  }

<span class="co">-- | Set up the server.</span>
<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  setNumCapabilities <span class="fu">=&lt;&lt;</span> getNumProcessors
  putStrLn <span class="st">&quot;Initializing Server&quot;</span>
  getRuntimeAndDocs
  setupLogging
  precompile
  cargs <span class="ot">&lt;-</span> cmdArgs flags
  httpServe (setPort (port cargs) defaultConfig) <span class="fu">$</span>
      ifTop (serveElm <span class="st">&quot;public/Empty.elm&quot;</span>)
      <span class="fu">&lt;|&gt;</span> route [ (<span class="st">&quot;try&quot;</span>, serveHtml Editor.empty)
                , (<span class="st">&quot;edit&quot;</span>, edit)
                , (<span class="st">&quot;_edit&quot;</span>, jsEdit) 
                , (<span class="st">&quot;code&quot;</span>, code)
                , (<span class="st">&quot;_code&quot;</span>, jsCode)
                , (<span class="st">&quot;compile&quot;</span>, compile)
                , (<span class="st">&quot;_compile&quot;</span>, jsCompile)
                , (<span class="st">&quot;hotswap&quot;</span>, hotswap)
                ]
      <span class="fu">&lt;|&gt;</span> error404

<span class="ot">error404 ::</span> <span class="dt">Snap</span> ()
error404 <span class="fu">=</span>
    <span class="kw">do</span> modifyResponse <span class="fu">$</span> setResponseStatus <span class="dv">404</span> <span class="st">&quot;Not found&quot;</span>
       serveElm <span class="st">&quot;public/build/Error404.elm&quot;</span>

<span class="ot">serveElm ::</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">Snap</span> ()
serveElm <span class="fu">=</span> serveFileAs <span class="st">&quot;text/html; charset=UTF-8&quot;</span>

<span class="ot">logAndServeJS ::</span> <span class="dt">MonadSnap</span> m <span class="ot">=&gt;</span> <span class="dt">H.Html</span> <span class="ot">-&gt;</span> m ()
logAndServeJS <span class="fu">=</span> serveHtml 

<span class="ot">logAndServeHtml ::</span> <span class="dt">MonadSnap</span> m <span class="ot">=&gt;</span> (<span class="dt">H.Html</span>, <span class="dt">Maybe</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> m ()
logAndServeHtml (html, <span class="dt">Nothing</span>)  <span class="fu">=</span> serveHtml html
logAndServeHtml (html, <span class="dt">Just</span> err) <span class="fu">=</span>
    <span class="kw">do</span> timeStamp <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readProcess <span class="st">&quot;date&quot;</span> [<span class="st">&quot;--rfc-3339=ns&quot;</span>] <span class="st">&quot;&quot;</span>
       liftIO <span class="fu">$</span> appendFile <span class="st">&quot;error_log.json&quot;</span> <span class="fu">$</span> <span class="st">&quot;{\&quot;&quot;</span> <span class="fu">++</span> (init timeStamp) 
                                                    <span class="fu">++</span> <span class="st">&quot;\&quot;,&quot;</span> 
                                                    <span class="fu">++</span> (show (lines err)) 
                                                    <span class="fu">++</span> <span class="st">&quot;},&quot;</span>
       setContentType <span class="st">&quot;text/html&quot;</span> <span class="fu">&lt;$&gt;</span> getResponse
       writeLBS (BlazeBS.renderHtml html)


<span class="ot">embedJS ::</span> <span class="dt">MonadSnap</span> m <span class="ot">=&gt;</span> <span class="dt">H.Html</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> m ()
embedJS js participant <span class="fu">=</span>
    <span class="kw">do</span> 
       elmSrc <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readFile <span class="st">&quot;EmbedMeJS.elm&quot;</span>
       setContentType <span class="st">&quot;text/html&quot;</span> <span class="fu">&lt;$&gt;</span> getResponse
       writeLBS (BlazeBS.renderHtml (embedMe elmSrc js participant))

<span class="ot">embedHtml ::</span> <span class="dt">MonadSnap</span> m <span class="ot">=&gt;</span> <span class="dt">H.Html</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> m ()
embedHtml html participant <span class="fu">=</span>
    <span class="kw">do</span> elmSrc <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readFile <span class="st">&quot;EmbedMeElm.elm&quot;</span>
       setContentType <span class="st">&quot;text/html&quot;</span> <span class="fu">&lt;$&gt;</span> getResponse
       writeLBS (BlazeBS.renderHtml (embedMe elmSrc html participant))

<span class="ot">serveHtml ::</span> <span class="dt">MonadSnap</span> m <span class="ot">=&gt;</span> <span class="dt">H.Html</span> <span class="ot">-&gt;</span> m ()
serveHtml html <span class="fu">=</span>
    <span class="kw">do</span> setContentType <span class="st">&quot;text/html&quot;</span> <span class="fu">&lt;$&gt;</span> getResponse
       writeLBS (BlazeBS.renderHtml html)

<span class="ot">hotswap ::</span> <span class="dt">Snap</span> ()
hotswap <span class="fu">=</span> maybe error404 serve <span class="fu">=&lt;&lt;</span> getParam <span class="st">&quot;input&quot;</span>
    <span class="kw">where</span>
      serve code <span class="fu">=</span>
          <span class="kw">do</span> setContentType <span class="st">&quot;application/javascript&quot;</span> <span class="fu">&lt;$&gt;</span> getResponse
             writeBS <span class="fu">.</span> BSC.pack <span class="fu">.</span> Generate.js <span class="fu">$</span> BSC.unpack code

<span class="ot">jsCompile ::</span> <span class="dt">Snap</span> ()
jsCompile <span class="fu">=</span> maybe error404 serve <span class="fu">=&lt;&lt;</span> getParam <span class="st">&quot;input&quot;</span>
    <span class="kw">where</span>
      serve <span class="fu">=</span> logAndServeJS <span class="fu">.</span> Generate.logAndJS <span class="st">&quot;Compiled JS&quot;</span> <span class="fu">.</span> BSC.unpack

<span class="ot">compile ::</span> <span class="dt">Snap</span> ()
compile <span class="fu">=</span> maybe error404 serve <span class="fu">=&lt;&lt;</span> getParam <span class="st">&quot;input&quot;</span>
    <span class="kw">where</span>
      serve <span class="fu">=</span> logAndServeHtml <span class="fu">.</span> Generate.logAndHtml <span class="st">&quot;Compiled Elm&quot;</span> <span class="fu">.</span> BSC.unpack

<span class="ot">edit ::</span> <span class="dt">Snap</span> ()
edit <span class="fu">=</span> <span class="kw">do</span>
  participant <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;&quot;</span> id <span class="fu">&lt;$&gt;</span> getParam <span class="st">&quot;p&quot;</span>
  cols <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;50%,50%&quot;</span> id <span class="fu">&lt;$&gt;</span> getQueryParam <span class="st">&quot;cols&quot;</span>
  withFile (Editor.ide cols participant) 

<span class="ot">jsEdit ::</span> <span class="dt">Snap</span> ()
jsEdit <span class="fu">=</span> <span class="kw">do</span>
  participant <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;&quot;</span> id <span class="fu">&lt;$&gt;</span> getParam <span class="st">&quot;p&quot;</span>
  cols <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;50%,50%&quot;</span> id <span class="fu">&lt;$&gt;</span> getQueryParam <span class="st">&quot;cols&quot;</span>
  withFile (Editor.jsIde cols participant)

<span class="ot">code ::</span> <span class="dt">Snap</span> ()
code <span class="fu">=</span> <span class="kw">do</span>
  participant <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;&quot;</span> id <span class="fu">&lt;$&gt;</span> getParam <span class="st">&quot;p&quot;</span>
  embedWithFile Editor.editor participant

<span class="ot">jsCode ::</span> <span class="dt">Snap</span> ()
jsCode <span class="fu">=</span> <span class="kw">do</span>
  participant <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> maybe <span class="st">&quot;&quot;</span> id <span class="fu">&lt;$&gt;</span> getParam <span class="st">&quot;p&quot;</span>
  jsEmbedWithFile Editor.jsEditor participant

<span class="ot">embedee ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
embedee elmSrc participant <span class="fu">=</span>
    H.span <span class="fu">$</span> <span class="kw">do</span>
      <span class="kw">case</span> Elm.compile elmSrc <span class="kw">of</span>
        <span class="dt">Right</span> jsSrc <span class="ot">-&gt;</span> <span class="kw">do</span>
            embed <span class="fu">$</span> H.preEscapedToMarkup (subRegex oldID jsSrc newID)
        <span class="dt">Left</span> err <span class="ot">-&gt;</span>
            H.span <span class="fu">!</span> A.style <span class="st">&quot;font-family: monospace;&quot;</span> <span class="fu">$</span>
            mapM_ addSpaces (lines err)
      script <span class="st">&quot;/fullScreenEmbedMe.js&quot;</span>
  <span class="kw">where</span> addSpaces line <span class="fu">=</span> H.preEscapedToMarkup (Generate.addSpaces line) <span class="fu">&gt;&gt;</span> H.br
        oldID <span class="fu">=</span> mkRegex <span class="st">&quot;var user_id = \&quot;1\&quot;;&quot;</span>
        newID <span class="fu">=</span> (<span class="st">&quot;var user_id = &quot;</span> <span class="fu">++</span> participant <span class="fu">++</span> <span class="st">&quot;+&#39;&#39;;&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)
        jsAttr <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
        script jsFile <span class="fu">=</span> jsAttr <span class="fu">!</span> A.src jsFile <span class="fu">$</span> mempty
        embed jsCode <span class="fu">=</span> jsAttr <span class="fu">$</span> jsCode

<span class="ot">embedMe ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
embedMe elmSrc target participant <span class="fu">=</span> target <span class="fu">&gt;&gt;</span> (embedee elmSrc participant)

<span class="ot">jsEmbedWithFile ::</span> (<span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Snap</span> ()
jsEmbedWithFile handler participant <span class="fu">=</span> <span class="kw">do</span>
  path <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> rqPathInfo <span class="fu">&lt;$&gt;</span> getRequest
  <span class="kw">let</span> file <span class="fu">=</span> <span class="st">&quot;public/&quot;</span> <span class="fu">++</span> path         
  exists <span class="ot">&lt;-</span> liftIO (doesFileExist file)
  <span class="kw">if</span> not exists <span class="kw">then</span> error404 <span class="kw">else</span>
      <span class="kw">do</span> content <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readFile file
         embedJS (handler path content) participant

<span class="ot">embedWithFile ::</span> (<span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Snap</span> ()
embedWithFile handler participant <span class="fu">=</span> <span class="kw">do</span>
  path <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> rqPathInfo <span class="fu">&lt;$&gt;</span> getRequest
  <span class="kw">let</span> file <span class="fu">=</span> <span class="st">&quot;public/&quot;</span> <span class="fu">++</span> path         
  exists <span class="ot">&lt;-</span> liftIO (doesFileExist file)
  <span class="kw">if</span> not exists <span class="kw">then</span> error404 <span class="kw">else</span>
      <span class="kw">do</span> content <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readFile file
         embedHtml (handler path content) participant
    
<span class="ot">withFile ::</span> (<span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>) <span class="ot">-&gt;</span> <span class="dt">Snap</span> ()
withFile handler <span class="fu">=</span> <span class="kw">do</span>
  path <span class="ot">&lt;-</span> BSC.unpack <span class="fu">.</span> rqPathInfo <span class="fu">&lt;$&gt;</span> getRequest
  <span class="kw">let</span> file <span class="fu">=</span> <span class="st">&quot;public/&quot;</span> <span class="fu">++</span> path         
  exists <span class="ot">&lt;-</span> liftIO (doesFileExist file)
  <span class="kw">if</span> not exists <span class="kw">then</span> error404 <span class="kw">else</span>
      <span class="kw">do</span> content <span class="ot">&lt;-</span> liftIO <span class="fu">$</span> readFile file
         serveHtml <span class="fu">$</span> handler path content

<span class="ot">setupLogging ::</span> <span class="dt">IO</span> ()
setupLogging <span class="fu">=</span>
    <span class="kw">do</span> createDirectoryIfMissing <span class="dt">True</span> <span class="st">&quot;log&quot;</span>
       createIfMissing <span class="st">&quot;log/access.log&quot;</span>
       createIfMissing <span class="st">&quot;log/error.log&quot;</span>
    <span class="kw">where</span>
      createIfMissing path <span class="fu">=</span> <span class="kw">do</span>
        exists <span class="ot">&lt;-</span> doesFileExist path
        when (not exists) <span class="fu">$</span> BS.writeFile path <span class="st">&quot;&quot;</span>

<span class="co">-- | Compile all of the Elm files in public/, put results in public/build/</span>
<span class="ot">precompile ::</span> <span class="dt">IO</span> ()
precompile <span class="fu">=</span>
  <span class="kw">do</span> setCurrentDirectory <span class="st">&quot;public&quot;</span>
     files <span class="ot">&lt;-</span> getFiles <span class="dt">True</span> <span class="st">&quot;.elm&quot;</span> <span class="st">&quot;.&quot;</span>
     forM_ files <span class="fu">$</span> \file <span class="ot">-&gt;</span> rawSystem <span class="st">&quot;elm&quot;</span> 
                                [<span class="st">&quot;--make&quot;</span>,<span class="st">&quot;--runtime=/elm-runtime.js&quot;</span>,file]
     htmls <span class="ot">&lt;-</span> getFiles <span class="dt">False</span> <span class="st">&quot;.html&quot;</span> <span class="st">&quot;build&quot;</span>
     mapM_ adjustHtmlFile htmls
     setCurrentDirectory <span class="st">&quot;..&quot;</span>
  <span class="kw">where</span>
<span class="ot">    getFiles ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> [<span class="dt">FilePath</span>]
    getFiles skip ext directory <span class="fu">=</span> 
        <span class="kw">if</span> skip <span class="fu">&amp;&amp;</span> <span class="st">&quot;build&quot;</span> <span class="ot">`elem`</span> map FP.dropTrailingPathSeparator 
                                        (FP.splitPath directory)
          <span class="kw">then</span> return [] <span class="kw">else</span>
          (<span class="kw">do</span> contents <span class="ot">&lt;-</span> map (directory <span class="fu">&lt;/&gt;</span>) <span class="ot">`fmap`</span> 
                                                getDirectoryContents directory
              <span class="kw">let</span> files <span class="fu">=</span> filter ((ext<span class="fu">==</span>) <span class="fu">.</span> FP.takeExtension) contents
                  directories  <span class="fu">=</span> filter (not <span class="fu">.</span> FP.hasExtension) contents
              filess <span class="ot">&lt;-</span> mapM (getFiles skip ext) directories
              return (files <span class="fu">++</span> concat filess))

<span class="ot">getRuntimeAndDocs ::</span> <span class="dt">IO</span> ()
getRuntimeAndDocs <span class="fu">=</span> <span class="kw">do</span>
  writeFile <span class="st">&quot;resources/elm-runtime.js&quot;</span> <span class="fu">=&lt;&lt;</span> readFile Elm.runtime
  writeFile <span class="st">&quot;resources/docs.json&quot;</span> <span class="fu">=&lt;&lt;</span> readFile Elm.docs

<span class="ot">adjustHtmlFile ::</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
adjustHtmlFile file <span class="fu">=</span>
  <span class="kw">do</span> src <span class="ot">&lt;-</span> BSC.readFile file
     <span class="kw">let</span> (before, after) <span class="fu">=</span> BSC.breakSubstring <span class="st">&quot;&lt;title&gt;&quot;</span> src
     BSC.writeFile (FP.replaceExtension file <span class="st">&quot;elm&quot;</span>) <span class="fu">$</span>
        BSC.concat [before, style, after]
     removeFile file

<span class="ot">style ::</span> <span class="dt">BSC.ByteString</span>
style <span class="fu">=</span> 
    <span class="st">&quot;&lt;style type=\&quot;text/css\&quot;&gt;\n\</span>
<span class="st">    \  a:link {text-decoration: none; color: rgb(15,102,230);}\n\</span>
<span class="st">    \  a:visited {text-decoration: none}\n\</span>
<span class="st">    \  a:active {text-decoration: none}\n\</span>
<span class="st">    \  a:hover {text-decoration: underline; color: rgb(234,21,122);}\n\</span>
<span class="st">    \  body { font-family: \&quot;Lucida Grande\&quot;,\&quot;Trebuchet MS\&quot;,\</span>
<span class="st">    \  \&quot;Bitstream Vera Sans\&quot;,Verdana,Helvetica,sans-serif !important; }\n\</span>
<span class="st">    \  p, li { font-size: 14px !important;\n\</span>
<span class="st">    \          line-height: 1.5em !important; }\n\</span>
<span class="st">    \&lt;/style&gt;&quot;</span></code></pre></td></tr></table>
<h3 id="editor.hs">Editor.hs </h3>
<table class="sourceCode haskell numberLines" include="code/server/Editor.hs"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>
<span class="kw">module</span> <span class="dt">Editor</span> (editor,jsEditor,jsIde,ide,empty) <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Monoid</span> (mempty)
<span class="kw">import </span><span class="dt">Text.Blaze.Html</span>
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5</span> <span class="kw">as</span> <span class="dt">H</span>
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5.Attributes</span> <span class="kw">as</span> <span class="dt">A</span>
<span class="kw">import </span><span class="dt">Network.HTTP.Base</span> (urlEncode)
<span class="kw">import qualified</span> <span class="dt">System.FilePath</span> <span class="kw">as</span> <span class="dt">FP</span>

<span class="kw">import qualified</span> <span class="dt">Elm.Internal.Utils</span> <span class="kw">as</span> <span class="dt">Elm</span>
<span class="kw">import </span><span class="dt">Data.Maybe</span> (fromMaybe)

<span class="kw">import </span><span class="dt">Generate</span> (addSpaces)


<span class="co">-- | Display an editor and the compiled result side-by-side.</span>
<span class="ot">jsIde ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
jsIde cols participant fileName code <span class="fu">=</span>
    jsIdeBuilder cols
                 participant
                 (<span class="st">&quot;JS Editor: &quot;</span> <span class="fu">++</span> FP.takeBaseName fileName)
                 fileName
                 (<span class="st">&quot;/_compile?input=&quot;</span> <span class="fu">++</span> urlEncode code)

<span class="co">-- | Display an editor and the compiled result side-by-side.</span>
<span class="ot">ide ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
ide cols participant fileName code <span class="fu">=</span>
    ideBuilder cols
               participant
               (<span class="st">&quot;Elm Editor: &quot;</span> <span class="fu">++</span> FP.takeBaseName fileName)
               fileName
               (<span class="st">&quot;/compile?input=&quot;</span> <span class="fu">++</span> urlEncode code)

<span class="co">-- | Display an editor and the compiled result side-by-side.</span>
<span class="ot">empty ::</span> <span class="dt">Html</span>
empty <span class="fu">=</span> ideBuilder <span class="st">&quot;50%,50%&quot;</span> <span class="st">&quot;1&quot;</span> <span class="st">&quot;Try Elm&quot;</span> <span class="st">&quot;Empty.elm&quot;</span> <span class="st">&quot;/Try.elm&quot;</span>

<span class="ot">jsIdeBuilder ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
jsIdeBuilder cols participant title input output <span class="fu">=</span>
    H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">.</span> H.title <span class="fu">.</span> toHtml <span class="fu">$</span> title
      preEscapedToMarkup <span class="fu">$</span> 
         concat [ <span class="st">&quot;&lt;frameset cols=\&quot;&quot;</span> <span class="fu">++</span> cols <span class="fu">++</span> <span class="st">&quot;\&quot;&gt;\n&quot;</span>
          , <span class="st">&quot;  &lt;frame name=\&quot;input\&quot; src=\&quot;/_code/&quot;</span>, input, <span class="st">&quot;?p=&quot;</span>, 
            participant, <span class="st">&quot;\&quot; /&gt;\n&quot;</span>
          , <span class="st">&quot;  &lt;frame name=\&quot;output\&quot; src=\&quot;&quot;</span>, output, <span class="st">&quot;\&quot; /&gt;\n&quot;</span>
          , <span class="st">&quot;&lt;/frameset&gt;&quot;</span> ]


<span class="ot">ideBuilder ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
ideBuilder cols participant title input output <span class="fu">=</span>
    H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">.</span> H.title <span class="fu">.</span> toHtml <span class="fu">$</span> title
      preEscapedToMarkup <span class="fu">$</span> 
         concat [ <span class="st">&quot;&lt;frameset cols=\&quot;&quot;</span> <span class="fu">++</span> cols <span class="fu">++</span> <span class="st">&quot;\&quot;&gt;\n&quot;</span>
                , <span class="st">&quot;  &lt;frame name=\&quot;input\&quot; src=\&quot;/code/&quot;</span>, input, <span class="st">&quot;?p=&quot;</span>, 
                  participant, <span class="st">&quot;\&quot; /&gt;\n&quot;</span>
                , <span class="st">&quot;  &lt;frame name=\&quot;output\&quot; src=\&quot;&quot;</span>, output, <span class="st">&quot;\&quot; /&gt;\n&quot;</span>
                , <span class="st">&quot;&lt;/frameset&gt;&quot;</span> ]

<span class="co">-- | list of themes to use with CodeMirror</span>
<span class="ot">themes ::</span> [<span class="dt">String</span>]
themes <span class="fu">=</span> [ <span class="st">&quot;ambiance&quot;</span>, <span class="st">&quot;blackboard&quot;</span>, <span class="st">&quot;cobalt&quot;</span>, <span class="st">&quot;eclipse&quot;</span>
         , <span class="st">&quot;elegant&quot;</span>, <span class="st">&quot;erlang-dark&quot;</span>, <span class="st">&quot;lesser-dark&quot;</span>, <span class="st">&quot;monokai&quot;</span>, <span class="st">&quot;neat&quot;</span>, <span class="st">&quot;night&quot;</span>
         , <span class="st">&quot;rubyblue&quot;</span>, <span class="st">&quot;solarized&quot;</span>, <span class="st">&quot;twilight&quot;</span>, <span class="st">&quot;vibrant-ink&quot;</span>, <span class="st">&quot;xq-dark&quot;</span> ]

<span class="ot">jsFiles ::</span> [<span class="dt">AttributeValue</span>]
jsFiles <span class="fu">=</span> [ <span class="st">&quot;/codemirror-3.x/lib/codemirror.js&quot;</span>
          , <span class="st">&quot;/codemirror-3.x/mode/elm/elm.js&quot;</span>
          , <span class="st">&quot;/misc/showdown.js&quot;</span>
          , <span class="st">&quot;/misc/editor.js?0.11&quot;</span> ]

<span class="ot">jsFiles2 ::</span> [<span class="dt">AttributeValue</span>]
jsFiles2 <span class="fu">=</span> [ <span class="st">&quot;/codemirror-3.x/lib/codemirror.js&quot;</span>
          , <span class="st">&quot;/codemirror-3.x/mode/javascript/javascript.js&quot;</span>
          , <span class="st">&quot;/misc/showdown.js&quot;</span>
          , <span class="st">&quot;/misc/editor.js?0.11&quot;</span> ]

<span class="ot">jsEditor ::</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
jsEditor filePath code <span class="fu">=</span>
    H.html <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.title <span class="fu">.</span> toHtml <span class="fu">$</span> <span class="st">&quot;JS Editor: &quot;</span> <span class="fu">++</span> FP.takeBaseName filePath
        H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> 
               <span class="fu">!</span> A.href <span class="st">&quot;/codemirror-3.x/lib/codemirror.css&quot;</span>
        mapM_ themeAttr themes
        H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> <span class="fu">!</span> A.type_ <span class="st">&quot;text/css&quot;</span> 
                                    <span class="fu">!</span> A.href <span class="st">&quot;/misc/editor.css&quot;</span>
        mapM_ script jsFiles2
        script <span class="st">&quot;/elm-runtime.js?0.11&quot;</span>
        script <span class="st">&quot;http://cdn.firebase.com/v0/firebase.js&quot;</span>
      H.body <span class="fu">$</span> <span class="kw">do</span>
        H.form <span class="fu">!</span> A.id <span class="st">&quot;inputForm&quot;</span> 
               <span class="fu">!</span> A.action <span class="st">&quot;/_compile&quot;</span> 
               <span class="fu">!</span> A.method <span class="st">&quot;post&quot;</span> 
               <span class="fu">!</span> A.target <span class="st">&quot;output&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
           H.div <span class="fu">!</span> A.id <span class="st">&quot;editor_box&quot;</span> <span class="fu">$</span>
             H.textarea <span class="fu">!</span> A.name <span class="st">&quot;input&quot;</span> <span class="fu">!</span> A.id <span class="st">&quot;input&quot;</span> <span class="fu">$</span> toHtml (<span class="ch">&#39;\n&#39;</span><span class="fu">:</span>code)
           H.div <span class="fu">!</span> A.id <span class="st">&quot;options&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
             bar <span class="st">&quot;documentation&quot;</span> docs
             bar <span class="st">&quot;editor_options&quot;</span> editorOptions
             bar <span class="st">&quot;always_on&quot;</span> (buttons <span class="fu">&gt;&gt;</span> options)
        embed <span class="st">&quot;initEditor();&quot;</span>
  <span class="kw">where</span> themeAttr theme <span class="fu">=</span> H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> 
                                 <span class="fu">!</span> A.href (toValue (<span class="st">&quot;/codemirror-3.x/theme/&quot;</span> 
                                                      <span class="fu">++</span> theme 
                                                      <span class="fu">++</span> <span class="st">&quot;.css&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>))
        jsAttr <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
        script jsFile <span class="fu">=</span> jsAttr <span class="fu">!</span> A.src jsFile <span class="fu">$</span> mempty
        embed jsCode <span class="fu">=</span> jsAttr <span class="fu">$</span> jsCode

<span class="co">-- | Create an HTML document that allows you to edit and submit Elm code</span>
<span class="co">--   for compilation.</span>
<span class="ot">editor ::</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
editor filePath code <span class="fu">=</span>
    H.html <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.title <span class="fu">.</span> toHtml <span class="fu">$</span> <span class="st">&quot;Elm Editor: &quot;</span> <span class="fu">++</span> FP.takeBaseName filePath
        H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> 
               <span class="fu">!</span> A.href <span class="st">&quot;/codemirror-3.x/lib/codemirror.css&quot;</span>
        mapM_ themeAttr themes
        H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> <span class="fu">!</span> A.type_ <span class="st">&quot;text/css&quot;</span> 
                                    <span class="fu">!</span> A.href <span class="st">&quot;/misc/editor.css&quot;</span>
        mapM_ script jsFiles
        script <span class="st">&quot;/elm-runtime.js?0.11&quot;</span>
        script <span class="st">&quot;http://cdn.firebase.com/v0/firebase.js&quot;</span>
      H.body <span class="fu">$</span> <span class="kw">do</span>
        H.form <span class="fu">!</span> A.id <span class="st">&quot;inputForm&quot;</span> 
               <span class="fu">!</span> A.action <span class="st">&quot;/compile&quot;</span> 
               <span class="fu">!</span> A.method <span class="st">&quot;post&quot;</span> 
               <span class="fu">!</span> A.target <span class="st">&quot;output&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
           H.div <span class="fu">!</span> A.id <span class="st">&quot;editor_box&quot;</span> <span class="fu">$</span>
             H.textarea <span class="fu">!</span> A.name <span class="st">&quot;input&quot;</span> <span class="fu">!</span> A.id <span class="st">&quot;input&quot;</span> <span class="fu">$</span> toHtml (<span class="ch">&#39;\n&#39;</span><span class="fu">:</span>code)
           H.div <span class="fu">!</span> A.id <span class="st">&quot;options&quot;</span> <span class="fu">$</span> <span class="kw">do</span>
             bar <span class="st">&quot;documentation&quot;</span> docs
             bar <span class="st">&quot;editor_options&quot;</span> editorOptions
             bar <span class="st">&quot;always_on&quot;</span> (buttons <span class="fu">&gt;&gt;</span> options)
        embed <span class="st">&quot;initEditor();&quot;</span>
  <span class="kw">where</span> themeAttr theme <span class="fu">=</span> H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> 
                                 <span class="fu">!</span> A.href (toValue (<span class="st">&quot;/codemirror-3.x/theme/&quot;</span> 
                                                      <span class="fu">++</span> theme 
                                                      <span class="fu">++</span> <span class="st">&quot;.css&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>))
        jsAttr <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
        script jsFile <span class="fu">=</span> jsAttr <span class="fu">!</span> A.src jsFile <span class="fu">$</span> mempty
        embed jsCode <span class="fu">=</span> jsAttr <span class="fu">$</span> jsCode

<span class="ot">bar ::</span> <span class="dt">AttributeValue</span> <span class="ot">-&gt;</span> <span class="dt">Html</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
bar id&#39; body <span class="fu">=</span> H.div <span class="fu">!</span> A.id id&#39; <span class="fu">!</span> A.class_ <span class="st">&quot;option&quot;</span> <span class="fu">$</span> body

<span class="ot">buttons ::</span> <span class="dt">Html</span>
buttons <span class="fu">=</span> H.div <span class="fu">!</span> A.class_ <span class="st">&quot;valign_kids&quot;</span>
                <span class="fu">!</span> A.style <span class="st">&quot;float:right; padding-right: 6px;&quot;</span>
                <span class="fu">$</span> compileButton
      <span class="kw">where</span>
        compileButton <span class="fu">=</span> 
            H.input
                 <span class="fu">!</span> A.type_ <span class="st">&quot;button&quot;</span>
                 <span class="fu">!</span> A.id <span class="st">&quot;compile_button&quot;</span>
                 <span class="fu">!</span> A.value <span class="st">&quot;Compile&quot;</span>
                 <span class="fu">!</span> A.onclick <span class="st">&quot;compile()&quot;</span>
                 <span class="fu">!</span> A.title <span class="st">&quot;Ctrl-Enter: change program behavior \</span>
<span class="st">                             \but keep the state&quot;</span>

<span class="ot">options ::</span> <span class="dt">Html</span>
options <span class="fu">=</span> H.div <span class="fu">!</span> A.class_ <span class="st">&quot;valign_kids&quot;</span>
                <span class="fu">!</span> A.style <span class="st">&quot;float:left; padding-left:6px; padding-top:2px;&quot;</span>
                <span class="fu">$</span> (docs&#39; <span class="fu">&gt;&gt;</span> opts)
    <span class="kw">where</span> 
      docs&#39; <span class="fu">=</span> 
        H.span  <span class="fu">!</span> A.title <span class="st">&quot;Show documentation and types.&quot;</span> <span class="fu">$</span> <span class="st">&quot;Hints:&quot;</span> <span class="fu">&gt;&gt;</span>
            H.input <span class="fu">!</span> A.type_ <span class="st">&quot;checkbox&quot;</span>
                    <span class="fu">!</span> A.id <span class="st">&quot;show_type_checkbox&quot;</span>
                    <span class="fu">!</span> A.onchange <span class="st">&quot;showType(this.checked);&quot;</span>

      opts <span class="fu">=</span> 
        H.span  <span class="fu">!</span> A.title <span class="st">&quot;Show editor options.&quot;</span> 
                <span class="fu">!</span> A.style <span class="st">&quot;padding-left: 12px;&quot;</span> <span class="fu">$</span> <span class="st">&quot;Options:&quot;</span> <span class="fu">&gt;&gt;</span>
            H.input <span class="fu">!</span> A.type_ <span class="st">&quot;checkbox&quot;</span>
                    <span class="fu">!</span> A.id <span class="st">&quot;options_checkbox&quot;</span> 
                    <span class="fu">!</span> A.onchange <span class="st">&quot;showOptions(this.checked);&quot;</span>

<span class="ot">editorOptions ::</span> <span class="dt">Html</span>
editorOptions <span class="fu">=</span> theme <span class="fu">&gt;&gt;</span> zoom <span class="fu">&gt;&gt;</span> lineNumbers
    <span class="kw">where</span>
<span class="ot">      optionFor ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Html</span>
      optionFor text <span class="fu">=</span>
          H.option <span class="fu">!</span> A.value (toValue text) <span class="fu">$</span> toHtml text

      theme <span class="fu">=</span>
          H.select <span class="fu">!</span> A.id <span class="st">&quot;editor_theme&quot;</span>
                   <span class="fu">!</span> A.onchange <span class="st">&quot;setTheme(this.value)&quot;</span>
                   <span class="fu">$</span> mapM_ optionFor themes
              
      zoom <span class="fu">=</span>
          H.select <span class="fu">!</span> A.id <span class="st">&quot;editor_zoom&quot;</span>
                   <span class="fu">!</span> A.onchange <span class="st">&quot;setZoom(this.options[this.selectedIndex].\</span>
<span class="st">                                  \innerHTML)&quot;</span>
                   <span class="fu">$</span> mapM_ optionFor [<span class="st">&quot;100%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;150%&quot;</span>, <span class="st">&quot;200%&quot;</span>]

      lineNumbers <span class="fu">=</span> <span class="kw">do</span>
        H.span <span class="fu">!</span> A.style <span class="st">&quot;padding-left: 16px;&quot;</span> <span class="fu">$</span> <span class="st">&quot;Line Numbers:&quot;</span>
        H.input <span class="fu">!</span> A.type_ <span class="st">&quot;checkbox&quot;</span>
                <span class="fu">!</span> A.id <span class="st">&quot;editor_lines&quot;</span>
                <span class="fu">!</span> A.onchange <span class="st">&quot;showLines(this.checked);&quot;</span>

<span class="ot">docs ::</span> <span class="dt">Html</span>
docs <span class="fu">=</span> tipe <span class="fu">&gt;&gt;</span> desc
    <span class="kw">where</span>
      tipe <span class="fu">=</span> H.div <span class="fu">!</span> A.class_ <span class="st">&quot;type&quot;</span> <span class="fu">$</span> message <span class="fu">&gt;&gt;</span> more

      message <span class="fu">=</span> H.div <span class="fu">!</span> 
                  A.style <span class="st">&quot;position:absolute; left:4px; right:36px;\</span>
<span class="st">                            \overflow:hidden; text-overflow:ellipsis;&quot;</span> <span class="fu">$</span> <span class="st">&quot;&quot;</span>

      more <span class="fu">=</span> H.a <span class="fu">!</span> A.id <span class="st">&quot;toggle_link&quot;</span>
                 <span class="fu">!</span> A.style <span class="st">&quot;display:none; float:right;&quot;</span>
                 <span class="fu">!</span> A.href <span class="st">&quot;javascript:toggleVerbose();&quot;</span>
                 <span class="fu">!</span> A.title <span class="st">&quot;Ctrl+H&quot;</span>
                 <span class="fu">$</span> <span class="st">&quot;&quot;</span>

      desc <span class="fu">=</span> H.div <span class="fu">!</span> A.class_ <span class="st">&quot;doc&quot;</span>
                   <span class="fu">!</span> A.style <span class="st">&quot;display:none;&quot;</span>
                   <span class="fu">$</span> <span class="st">&quot;&quot;</span>
</code></pre></td></tr></table>
<h3 id="generate.hs">Generate.hs </h3>
<table class="sourceCode haskell numberLines" include="code/server/Generate.hs"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span>
<span class="kw">module</span> <span class="dt">Generate</span> (logAndJS, logAndHtml, html, js, addSpaces) <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Data.Monoid</span> (mempty)
<span class="kw">import </span><span class="dt">Data.Maybe</span> (fromMaybe)
<span class="kw">import </span><span class="dt">Text.Blaze</span> (preEscapedToMarkup)
<span class="kw">import </span><span class="dt">Text.Blaze.Html5</span> ((!))
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5</span> <span class="kw">as</span> <span class="dt">H</span>
<span class="kw">import qualified</span> <span class="dt">Text.Blaze.Html5.Attributes</span> <span class="kw">as</span> <span class="dt">A</span>

<span class="kw">import qualified</span> <span class="dt">Elm.Internal.Utils</span> <span class="kw">as</span> <span class="dt">Elm</span>
<span class="kw">import </span><span class="dt">Utils</span>

<span class="ot">logAndJS ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
logAndJS name src <span class="fu">=</span> getJSPage name src

<span class="ot">logAndHtml ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> (<span class="dt">H.Html</span>, <span class="dt">Maybe</span> <span class="dt">String</span>)
logAndHtml name src <span class="fu">=</span>
    <span class="kw">let</span> elmname <span class="fu">=</span> <span class="st">&quot;Elm.&quot;</span> <span class="fu">++</span> fromMaybe <span class="st">&quot;Main&quot;</span> (Elm.moduleName src) 
    <span class="kw">in</span>
      <span class="kw">case</span> Elm.compile src <span class="kw">of</span>
          <span class="dt">Right</span> jsSrc <span class="ot">-&gt;</span> <span class="kw">do</span>
              (getHtmlPage name elmname jsSrc, <span class="dt">Nothing</span>)
          <span class="dt">Left</span> err <span class="ot">-&gt;</span> <span class="kw">do</span>
              (getErrPage name err, <span class="dt">Just</span> err)

<span class="ot">getJSPage ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
getJSPage name jsSrc <span class="fu">=</span>
  H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.meta <span class="fu">!</span> A.charset <span class="st">&quot;UTF-8&quot;</span>
        H.title <span class="fu">.</span> H.toHtml <span class="fu">$</span> name
        H.link <span class="fu">!</span> A.rel <span class="st">&quot;stylesheet&quot;</span> <span class="fu">!</span> A.type_ <span class="st">&quot;text/css&quot;</span> 
                                    <span class="fu">!</span> A.href <span class="st">&quot;/misc/js.css&quot;</span>
        script <span class="st">&quot;/pixi.js&quot;</span>
      H.body <span class="fu">$</span> <span class="kw">do</span>
        H.div <span class="fu">!</span> A.style <span class="st">&quot;width: 400px; height: 400px; position:\</span>
<span class="st">                        \ absolute; top: 0; left: 0; opacity: 0;&quot;</span> <span class="fu">$</span> mempty
        jsAttr <span class="fu">$</span> preEscapedToMarkup jsSrc
 <span class="kw">where</span> jsAttr <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
       script jsFile <span class="fu">=</span> jsAttr <span class="fu">!</span> A.src jsFile <span class="fu">$</span> mempty
       embed jsCode <span class="fu">=</span> jsAttr <span class="fu">$</span> jsCode

<span class="ot">getHtmlPage ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
getHtmlPage name elmname jsSrc <span class="fu">=</span>
  H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.meta <span class="fu">!</span> A.charset <span class="st">&quot;UTF-8&quot;</span>
        H.title <span class="fu">.</span> H.toHtml <span class="fu">$</span> name
        H.style <span class="fu">!</span> A.type_ <span class="st">&quot;text/css&quot;</span> <span class="fu">$</span> preEscapedToMarkup
         (<span class="st">&quot;a:link {text-decoration: none; color: rgb(15,102,230);}\n\</span>
<span class="st">          \a:visited {text-decoration: none}\n\</span>
<span class="st">          \a:active {text-decoration: none}\n\</span>
<span class="st">          \a:hover {text-decoration: underline; \</span>
<span class="st">          \color: rgb(234,21,122);}&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)
      H.body <span class="fu">$</span> <span class="kw">do</span>
        <span class="kw">let</span> js <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
            runFullscreen <span class="fu">=</span> 
                <span class="st">&quot;var runningElmModule = Elm.fullscreen(&quot;</span> <span class="fu">++</span> elmname 
                                                         <span class="fu">++</span> <span class="st">&quot;)&quot;</span>
        js <span class="fu">!</span> A.src (H.toValue (<span class="st">&quot;/elm-runtime.js?0.11&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)) <span class="fu">$</span> <span class="st">&quot;&quot;</span>
        js <span class="fu">$</span> preEscapedToMarkup jsSrc
        js <span class="fu">$</span> preEscapedToMarkup runFullscreen

<span class="ot">getErrPage ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
getErrPage name err <span class="fu">=</span>
  H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.meta <span class="fu">!</span> A.charset <span class="st">&quot;UTF-8&quot;</span>
        H.title <span class="fu">.</span> H.toHtml <span class="fu">$</span> name
      H.body <span class="fu">$</span>
        H.span <span class="fu">!</span> A.style <span class="st">&quot;font-family: monospace;&quot;</span> <span class="fu">$</span>
        mapM_ (\line <span class="ot">-&gt;</span> preEscapedToMarkup (addSpaces line) <span class="fu">&gt;&gt;</span> H.br) 
                (lines err)
    
            

<span class="co">-- | Using a page title and the full source of an Elm program, compile down to</span>
<span class="co">--   a valid HTML document.</span>
<span class="ot">html ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">H.Html</span>
html name src <span class="fu">=</span>
  H.docTypeHtml <span class="fu">$</span> <span class="kw">do</span>
      H.head <span class="fu">$</span> <span class="kw">do</span>
        H.meta <span class="fu">!</span> A.charset <span class="st">&quot;UTF-8&quot;</span>
        H.title <span class="fu">.</span> H.toHtml <span class="fu">$</span> name
        H.style <span class="fu">!</span> A.type_ <span class="st">&quot;text/css&quot;</span> <span class="fu">$</span> preEscapedToMarkup
         (<span class="st">&quot;a:link {text-decoration: none; color: rgb(15,102,230);}\n\</span>
<span class="st">          \a:visited {text-decoration: none}\n\</span>
<span class="st">          \a:active {text-decoration: none}\n\</span>
<span class="st">          \a:hover {text-decoration: underline;\</span>
<span class="st">          \ color: rgb(234,21,122);}&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)
      H.body <span class="fu">$</span> <span class="kw">do</span>
        <span class="kw">let</span> js <span class="fu">=</span> H.script <span class="fu">!</span> A.type_ <span class="st">&quot;text/javascript&quot;</span>
            elmname <span class="fu">=</span> <span class="st">&quot;Elm.&quot;</span> <span class="fu">++</span> fromMaybe <span class="st">&quot;Main&quot;</span> (Elm.moduleName src)
            runFullscreen <span class="fu">=</span> 
                  <span class="st">&quot;var runningElmModule = Elm.fullscreen(&quot;</span> <span class="fu">++</span> elmname 
                                                           <span class="fu">++</span> <span class="st">&quot;)&quot;</span>
        js <span class="fu">!</span> A.src (H.toValue (<span class="st">&quot;/elm-runtime.js?0.11&quot;</span><span class="ot"> ::</span> <span class="dt">String</span>)) <span class="fu">$</span> <span class="st">&quot;&quot;</span>
        <span class="kw">case</span> Elm.compile src <span class="kw">of</span>
          <span class="dt">Right</span> jsSrc <span class="ot">-&gt;</span> <span class="kw">do</span>
              js <span class="fu">$</span> preEscapedToMarkup jsSrc
              js <span class="fu">$</span> preEscapedToMarkup runFullscreen
          <span class="dt">Left</span> err <span class="ot">-&gt;</span>
              H.span <span class="fu">!</span> A.style <span class="st">&quot;font-family: monospace;&quot;</span> <span class="fu">$</span>
              mapM_ (\line <span class="ot">-&gt;</span> preEscapedToMarkup (addSpaces line) <span class="fu">&gt;&gt;</span> H.br) 
                      (lines err)

<span class="ot">addSpaces ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
addSpaces str <span class="fu">=</span>
  <span class="kw">case</span> str <span class="kw">of</span>
    <span class="ch">&#39; &#39;</span> <span class="fu">:</span> <span class="ch">&#39; &#39;</span> <span class="fu">:</span> rest <span class="ot">-&gt;</span> <span class="st">&quot; &amp;nbsp;&quot;</span> <span class="fu">++</span> addSpaces rest
    c <span class="fu">:</span> rest <span class="ot">-&gt;</span> c <span class="fu">:</span> addSpaces rest
    [] <span class="ot">-&gt;</span> []

<span class="ot">js ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>
js src <span class="fu">=</span> <span class="kw">case</span> Elm.compile src <span class="kw">of</span>
           <span class="dt">Right</span> js <span class="ot">-&gt;</span> <span class="st">&quot;{ \&quot;success\&quot; : &quot;</span> <span class="fu">++</span> show js <span class="fu">++</span> <span class="st">&quot; }&quot;</span>
           <span class="dt">Left</span> err <span class="ot">-&gt;</span> <span class="st">&quot;{ \&quot;error\&quot; : &quot;</span> <span class="fu">++</span> show err <span class="fu">++</span> <span class="st">&quot; }&quot;</span></code></pre></td></tr></table>
<h3 id="embedmeelm.elm-labelembedelm">EmbedMeElm.elm \label{embedElm{</h3>
<table class="sourceCode haskell numberLines" include="code/EmbedMeElm.elm"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">EmbedMe</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Mouse</span>
<span class="kw">import </span><span class="dt">Window</span>
<span class="kw">import </span><span class="dt">Keyboard</span>
<span class="kw">import </span><span class="dt">JavaScript</span> <span class="kw">as</span> <span class="dt">JS</span>
<span class="kw">import </span><span class="dt">JavaScript.Experimental</span> <span class="kw">as</span> <span class="dt">JEXP</span>
<span class="kw">import </span><span class="dt">Http</span>
<span class="kw">import </span><span class="dt">Json</span>

(<span class="fu">~&gt;</span>) <span class="fu">=</span> flip lift
<span class="kw">infixl</span> <span class="dv">4</span> <span class="fu">~&gt;</span>

clicks <span class="fu">:</span> <span class="dt">Signal</span> (<span class="dt">Time</span>, (<span class="dt">Int</span>,<span class="dt">Int</span>))
clicks <span class="fu">=</span> timestamp (sampleOn Mouse.isDown Mouse.position)

user_id <span class="fu">=</span> <span class="st">&quot;1&quot;</span>

firebaseRequest requestType requestData <span class="fu">=</span> 
  Http.request requestType 
    (<span class="st">&quot;https://sweltering-fire-9141.firebaseio.com/dissertation/elm/&quot;</span> <span class="fu">++</span> user_id 
                                                                     <span class="fu">++</span> <span class="st">&quot;.json&quot;</span>) 
    requestData []
 
serialize r <span class="fu">=</span> r <span class="fu">|&gt;</span> JEXP.fromRecord 
                <span class="fu">|&gt;</span> Json.fromJSObject 
                <span class="fu">|&gt;</span> Json.toJSString <span class="st">&quot; &quot;</span> 
                <span class="fu">|&gt;</span> JS.toString
 
toRequestData (t, (x,y)) <span class="fu">=</span> {t <span class="fu">=</span> t, x <span class="fu">=</span> x, y <span class="fu">=</span> y} <span class="fu">|&gt;</span> serialize
 
toRequest event <span class="fu">=</span> <span class="kw">case</span> event <span class="kw">of</span> 
  (t, (x,y)) <span class="ot">-&gt;</span> firebaseRequest <span class="st">&quot;post&quot;</span> (event <span class="fu">|&gt;</span> toRequestData)
 
requests <span class="fu">=</span> clicks <span class="fu">~&gt;</span> toRequest
 
sendRequests <span class="fu">=</span> Http.send requests</code></pre></td></tr></table>
<h3 id="embedmejs.elm">EmbedMeJS.elm </h3>
<table class="sourceCode haskell numberLines" include="code/EmbedMeJS.elm"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">EmbedMe</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">Mouse</span>
<span class="kw">import </span><span class="dt">Window</span>
<span class="kw">import </span><span class="dt">Keyboard</span>
<span class="kw">import </span><span class="dt">JavaScript</span> <span class="kw">as</span> <span class="dt">JS</span>
<span class="kw">import </span><span class="dt">JavaScript.Experimental</span> <span class="kw">as</span> <span class="dt">JEXP</span>
<span class="kw">import </span><span class="dt">Http</span>
<span class="kw">import </span><span class="dt">Json</span>

(<span class="fu">~&gt;</span>) <span class="fu">=</span> flip lift
<span class="kw">infixl</span> <span class="dv">4</span> <span class="fu">~&gt;</span>

clicks <span class="fu">:</span> <span class="dt">Signal</span> (<span class="dt">Time</span>, (<span class="dt">Int</span>,<span class="dt">Int</span>))
clicks <span class="fu">=</span> timestamp (sampleOn Mouse.isDown Mouse.position)

user_id <span class="fu">=</span> <span class="st">&quot;1&quot;</span>

firebaseRequest requestType requestData <span class="fu">=</span> 
  Http.request requestType 
    (<span class="st">&quot;https://sweltering-fire-9141.firebaseio.com/dissertation/js/&quot;</span> <span class="fu">++</span> user_id 
                                                                    <span class="fu">++</span> <span class="st">&quot;.json&quot;</span>) 
    requestData []
 
serialize r <span class="fu">=</span> r <span class="fu">|&gt;</span> JEXP.fromRecord 
                <span class="fu">|&gt;</span> Json.fromJSObject 
                <span class="fu">|&gt;</span> Json.toJSString <span class="st">&quot; &quot;</span> 
                <span class="fu">|&gt;</span> JS.toString
 
toRequestData (t, (x,y)) <span class="fu">=</span> {t <span class="fu">=</span> t, x <span class="fu">=</span> x, y <span class="fu">=</span> y} <span class="fu">|&gt;</span> serialize
 
toRequest event <span class="fu">=</span> <span class="kw">case</span> event <span class="kw">of</span> 
  (t, (x,y)) <span class="ot">-&gt;</span> firebaseRequest <span class="st">&quot;post&quot;</span> (event <span class="fu">|&gt;</span> toRequestData)
 
requests <span class="fu">=</span> clicks <span class="fu">~&gt;</span> toRequest
 
sendRequests <span class="fu">=</span> Http.send requests</code></pre></td></tr></table>
<h3 id="fullscreenembedme.js">fullScreenEmbedMe.js </h3>
<table class="sourceCode javascript numberLines" include="code/fullScreenEmbedMe.js"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
</pre></td><td class="sourceCode"><pre><code class="sourceCode javascript"><span class="kw">var</span> firebaseData = <span class="kw">new</span> <span class="fu">Firebase</span>(
		<span class="st">&#39;https://sweltering-fire-9141.firebaseio.com/dissertation&#39;</span>);
<span class="kw">var</span> embedMe = <span class="ot">Elm</span>.<span class="fu">fullscreen</span>(<span class="ot">Elm</span>.<span class="fu">EmbedMe</span>, {});</code></pre></td></tr></table>
<h3 id="editor.js.diff">editor.js.diff</h3>
<table class="sourceCode diff numberLines" include="code/editor.js.diff"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="sourceCode"><pre><code class="sourceCode diff"><span class="kw">diff --git a/resources/misc/editor.js b/resources/misc/editor.js</span>
index d2bebc8..302663e 100644
<span class="dt">--- a/resources/misc/editor.js</span>
<span class="dt">+++ b/resources/misc/editor.js</span>
<span class="dt">@@ -293,7 +293,7 @@ function showOptions(show) {</span>
 function showType(show) {
     cookie(&#39;showtype&#39;, show);
     document.getElementById(&#39;show_type_checkbox&#39;).checked = show;
<span class="st">-    var newMode = (show ? { mode: Mode.TYPES, verbose: false }</span>
<span class="ot">+    var newMode = (show ? { mode: Mode.TYPES, verbose: true}</span>
                         : { mode: Mode.NONE });
     if (mode.mode === Mode.OPTIONS) {
         mode.hidden = newMode;
<span class="dt">@@ -305,8 +305,8 @@ function showType(show) {</span>
 
 function toggleVerbose() {
     if (!mode.verbose) showType(true);
<span class="st">-    document.getElementById(&#39;toggle_link&#39;).innerHTML = mode.verbose ? </span>
<span class="st">-      &#39;more&#39; : &#39;less&#39;;</span>
<span class="st">-    mode.verbose = !mode.verbose;</span>
<span class="ot">+    document.getElementById(&#39;toggle_link&#39;).innerHTML = mode.verbose ? &#39;&#39; : &#39;&#39;;</span>
<span class="ot">+    mode.verbose = true;</span>
     updateDocumentation();
 }
 
<span class="dt">@@ -318,8 +318,8 @@ function showVerbose() {</span>
 function hideStuff() {
     if (mode.hidden) mode = mode.hidden;
     document.getElementById(&#39;options_checkbox&#39;).checked = false;
<span class="st">-    mode.verbose = false;</span>
<span class="st">-    document.getElementById(&#39;toggle_link&#39;).innerHTML = &#39;more&#39;;</span>
<span class="ot">+    mode.verbose = true;</span>
<span class="ot">+    document.getElementById(&#39;toggle_link&#39;).innerHTML = &#39;&#39;;</span>
     updateDocumentation();
 }</code></pre></td></tr></table>
<h3 id="movingbox.js">MovingBox.js </h3>
<table class="sourceCode javascript numberLines" include="code/public/task/MovingBox.js"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="sourceCode"><pre><code class="sourceCode javascript"><span class="co">/* </span>
<span class="co"></span>
<span class="co">Try moving the square around with your keyboard&#39;s arrow keys</span>
<span class="co"></span>
<span class="co">Click your mouse over there =====&gt; </span>
<span class="co">Use arrows Up, Down, Left, Right</span>
<span class="co"></span>
<span class="co">Whee!</span>
<span class="co"></span>
<span class="co">Now modify the code to prevent the square from going outside </span>
<span class="co">the edge of the grey window.</span>
<span class="co"></span>
<span class="co">*/</span>

<span class="kw">var</span> WIDTH = <span class="dv">400</span>;
<span class="kw">var</span> HEIGHT = <span class="dv">400</span>;
<span class="kw">var</span> SQUARE = <span class="dv">40</span>;
<span class="kw">var</span> COLORS = [
    <span class="st">&quot;0x000000&quot;</span>,
    <span class="st">&quot;0xCCCCCC&quot;</span>,
];
<span class="kw">var</span> MOVEMENT_SPEED = <span class="dv">5</span>;

<span class="kw">var</span> stage = <span class="kw">new</span> <span class="ot">PIXI</span>.<span class="fu">Stage</span>(COLORS[<span class="dv">1</span>]);
<span class="kw">var</span> renderer = <span class="ot">PIXI</span>.<span class="fu">autoDetectRenderer</span>(WIDTH, HEIGHT);
<span class="ot">document</span>.<span class="ot">body</span>.<span class="fu">appendChild</span>(<span class="ot">renderer</span>.<span class="fu">view</span>);

<span class="kw">var</span> box = <span class="kw">new</span> <span class="ot">PIXI</span>.<span class="fu">Graphics</span>();
<span class="ot">box</span>.<span class="fu">lineStyle</span>(<span class="dv">1</span>, COLORS[<span class="dv">0</span>], <span class="dv">1</span>);
<span class="ot">box</span>.<span class="fu">beginFill</span>(COLORS[<span class="dv">1</span>], <span class="dv">0</span>);
<span class="ot">box</span>.<span class="fu">drawRect</span>(<span class="dv">0</span>, <span class="dv">0</span>, SQUARE, SQUARE);
<span class="ot">box</span>.<span class="fu">endFill</span>();
<span class="ot">stage</span>.<span class="fu">addChild</span>(box);

<span class="ot">box</span>.<span class="fu">x</span> = (WIDTH / <span class="dv">2</span>) - (SQUARE / <span class="dv">2</span>);
<span class="ot">box</span>.<span class="fu">y</span> = (HEIGHT / <span class="dv">2</span>) - (SQUARE / <span class="dv">2</span>);

<span class="kw">var</span> keyState = {};

<span class="ot">window</span>.<span class="fu">addEventListener</span>(<span class="st">&#39;keydown&#39;</span>, <span class="kw">function</span>(e) {
    keyState[<span class="ot">e</span>.<span class="fu">keyCode</span> || <span class="ot">e</span>.<span class="fu">which</span>] = <span class="kw">true</span>;
}, <span class="kw">true</span>);

<span class="ot">window</span>.<span class="fu">addEventListener</span>(<span class="st">&#39;keyup&#39;</span>, <span class="kw">function</span>(e) {
    keyState[<span class="ot">e</span>.<span class="fu">keyCode</span> || <span class="ot">e</span>.<span class="fu">which</span>] = <span class="kw">false</span>;
}, <span class="kw">true</span>);

<span class="fu">requestAnimFrame</span>(animate);

<span class="kw">function</span> <span class="fu">animate</span>() {
    <span class="kw">if</span> (keyState[<span class="dv">37</span>]) {
        <span class="ot">box</span>.<span class="fu">x</span> -= MOVEMENT_SPEED;
    }

    <span class="kw">if</span> (keyState[<span class="dv">38</span>]) {
        <span class="ot">box</span>.<span class="fu">y</span> -= MOVEMENT_SPEED;
    }

    <span class="kw">if</span> (keyState[<span class="dv">39</span>]) {
        <span class="ot">box</span>.<span class="fu">x</span> += MOVEMENT_SPEED;
    }

    <span class="kw">if</span> (keyState[<span class="dv">40</span>]) {
        <span class="ot">box</span>.<span class="fu">y</span> += MOVEMENT_SPEED;
    }

    <span class="ot">renderer</span>.<span class="fu">render</span>(stage);
    <span class="fu">requestAnimFrame</span>(animate);
}</code></pre></td></tr></table>
<h3 id="movingbox.elm">MovingBox.elm </h3>
<table class="sourceCode haskell numberLines" include="code/public/task/MovingBox.elm"><tr class="sourceCode"><td class="lineNumbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre></td><td class="sourceCode"><pre><code class="sourceCode haskell"><span class="co">{- </span>

<span class="co">Try moving the square around with your keyboard&#39;s arrow keys</span>

<span class="co">Click your mouse over there =====&gt; </span>
<span class="co">Use arrows Up, Down, Left, Right</span>

<span class="co">Whee!</span>

<span class="co">Now modify the code to prevent the square from going outside </span>
<span class="co">the edge of the grey window.</span>

<span class="co">-}</span>

<span class="kw">import </span><span class="dt">Keyboard</span>

areaSize <span class="fu">=</span> <span class="dv">400</span>
squareSize <span class="fu">=</span> <span class="dv">40</span>

main <span class="fu">:</span> <span class="dt">Signal</span> <span class="dt">Element</span>
main <span class="fu">=</span> lift display position

delta <span class="fu">:</span> <span class="dt">Signal</span> <span class="dt">Float</span>
delta <span class="fu">=</span> fps <span class="dv">30</span>

input <span class="fu">:</span> <span class="dt">Signal</span> (<span class="dt">Float</span>, (<span class="dt">Float</span>,<span class="dt">Float</span>))
input <span class="fu">=</span>
    <span class="kw">let</span> vectors <span class="fu">=</span> lift toVector Keyboard.arrows
    <span class="kw">in</span>  sampleOn delta (lift2 (,) delta vectors)

toVector <span class="fu">:</span> { x<span class="fu">:</span><span class="dt">Int</span>, y<span class="fu">:</span><span class="dt">Int</span> } <span class="ot">-&gt;</span> (<span class="dt">Float</span>,<span class="dt">Float</span>)
toVector {x,y} <span class="fu">=</span>
    <span class="kw">if</span> x <span class="fu">/=</span> <span class="dv">0</span> <span class="fu">&amp;&amp;</span> y <span class="fu">/=</span> <span class="dv">0</span>
      <span class="kw">then</span> (x <span class="fu">/</span> sqrt <span class="dv">2</span>, y <span class="fu">/</span> sqrt <span class="dv">2</span>)
      <span class="kw">else</span> (x,y)

position <span class="fu">:</span> <span class="dt">Signal</span> (<span class="dt">Float</span>,<span class="dt">Float</span>)
position <span class="fu">=</span> foldp update (<span class="dv">0</span>,<span class="dv">0</span>) input

update <span class="fu">:</span> (<span class="dt">Float</span>, (<span class="dt">Float</span>,<span class="dt">Float</span>)) <span class="ot">-&gt;</span> (<span class="dt">Float</span>,<span class="dt">Float</span>) <span class="ot">-&gt;</span> (<span class="dt">Float</span>,<span class="dt">Float</span>)
update (dt,(vx,vy)) (x,y) <span class="fu">=</span>
    (x <span class="fu">+</span> dt <span class="fu">*</span> vx <span class="fu">/</span> <span class="dv">2</span>, y <span class="fu">+</span> dt <span class="fu">*</span> vy <span class="fu">/</span> <span class="dv">2</span>)

display <span class="fu">:</span> (<span class="dt">Float</span>,<span class="dt">Float</span>) <span class="ot">-&gt;</span> <span class="dt">Element</span>
display xy <span class="fu">=</span>
    collage (round areaSize) (round areaSize)
      [ rect areaSize areaSize
          <span class="fu">|&gt;</span> filled grey
      , rect squareSize squareSize
          <span class="fu">|&gt;</span> outlined (solid black)
          <span class="fu">|&gt;</span> move xy
      ]</code></pre></td></tr></table>
<h1 id="appendix-d" class="unnumbered">Appendix D</h1>
<h2 id="pilot-study-1----questionnaire">Pilot Study 1 -- Questionnaire </h2>
<h3 id="consent-form">Consent Form</h3>
<h4 id="study-overview">Study Overview</h4>
<p>This study aims to assess how Functional Reactive Programming Languages are used. To do this, we will be asking you to modify a Mario game to get him to fly. The session will take no more than 1 hour.</p>
<p>During the session, you will be introduced to Elm, a functional reactive programming language, as well as being shown what we want you to create. We’ll also present you with a questionnaire to see what experience you’ve had with Functional programming (or similar concepts) before. Finally we’ll give you another questionnaire to ask how you think the session went, and the level of workload in the task.</p>
<p>The session will be recorded on video and then the audio from the session will be transcribed anonymously in order to find any problems that you had during the session. During this process, the data will be stored securely. Important Information</p>
<p>All data collected during this study will be recorded such that your individual results are anonymous and cannot be traced back to you. Your results will not be passed to any third party and are not being collected for commercial reasons. Participation in this study does not involve physical or mental risks outside of those encountered in everyday life. All procedures and information can be taken at face value and no deception is involved. You have the right to withdraw from the study at any time and to have any data about you destroyed. If you do decide to withdraw, please inform the experimenter.</p>
<p>By signing this form you acknowledge that you have read the information given above and understand the terms and conditions of this study.</p>
<table>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">Age</td>
<td align="left">Sex</td>
<td align="left">Occupation</td>
</tr>
<tr class="even">
<td align="left">................</td>
<td align="left">...</td>
<td align="left">...</td>
<td align="left">..................</td>
</tr>
</tbody>
</table>
<p>Signed</p>
<ul>
<li>.................</li>
</ul>
<p>Date</p>
<ul>
<li>.................</li>
</ul>
<p>Experimenter: Simon Buist, Dept. of Computer Science. EMAIL ADDRESS</p>
<h3 id="pre-questionnaire">Pre-questionnaire</h3>
<h4 id="functional-programming-languages">Functional Programming languages</h4>
<ol style="list-style-type: decimal">
<li>Have you ever used a Functional programming language before? Examples are: Scheme, Lisp, Haskell, ML, SPARK. Please circle one answer)
<ul>
<li>Yes</li>
<li>No</li>
</ul></li>
<li>If so, please list the Functional programming languages you’ve used before:
<ul>
<li>.............................................................</li>
</ul></li>
</ol>
<h4 id="design-software">Design &amp; Software</h4>
<p>For the purposes of this questionnaire, we consider a piece of software to be an application for which you have received/conceived of a specification, and coded a solution that meets this solution.</p>
<ol style="list-style-type: decimal">
<li>Have you designed software before?
<ul>
<li>Yes</li>
<li>No</li>
</ul></li>
<li>On what platforms have you designed software?
<ul>
<li>Desktop</li>
<li>Mobile</li>
<li>Tablet</li>
<li>Web</li>
</ul></li>
<li>For what purposes have you designed software?
<ul>
<li>Commercial</li>
<li>Academic (e.g. Coursework)</li>
<li>Personal project</li>
<li>Other:</li>
</ul></li>
<li>Roughly how many pieces of software have you designed?
<ul>
<li>...</li>
</ul></li>
<li>What programming languages do you know?
<ul>
<li>.............................................................</li>
</ul></li>
</ol>
<h4 id="general-demographics">General Demographics</h4>
<ol style="list-style-type: decimal">
<li>How old are you?
<ul>
<li>...</li>
</ul></li>
<li>What is your sex? (Please circle one answer)
<ul>
<li>Male</li>
<li>Female</li>
</ul></li>
<li>What is the highest degree or level of education you have completed? If currently enrolled please indicate the highest you have attained previously. (Please circle one answer)
<ul>
<li>None</li>
<li>GCSEs or equivalent</li>
<li>A/AS levels or equivalent</li>
<li>BSc/BA or equivalent</li>
<li>MSc/MA or equivalent</li>
<li>PhD or equivalent</li>
</ul></li>
<li>In what field was your highest qualification?
<ul>
<li>.........................</li>
</ul></li>
<li>What is your current employment status? (Please circle one answer)
<ul>
<li>Unemployed</li>
<li>Self-employed</li>
<li>Employed</li>
<li>Student</li>
<li>Retired</li>
<li>Unable to work</li>
</ul></li>
</ol>
<h3 id="post-questionnaire">Post-Questionnaire</h3>
<ol style="list-style-type: decimal">
<li>Please detail any comments on the result that you achieved</li>
</ol>
<p>.............................................................</p>
<p>.............................................................</p>
<p>.............................................................</p>
<ol start="2" style="list-style-type: decimal">
<li>Please detail any comments on how you achieved it</li>
</ol>
<p>.............................................................</p>
<p>.............................................................</p>
<p>.............................................................</p>
<ol start="3" style="list-style-type: decimal">
<li>Please detail any other comments</li>
</ol>
<p>.............................................................</p>
<p>.............................................................</p>
<p>.............................................................</p>
<hr />
<p>If you want to have the study as a whole explained to you, please do so now. However we ask that you refrain from discussing this with potential future participants.</p>
</div> <!-- grid 9 -->
</div> <!-- Containter 12 -->
</body>
</html>
